var douUI;!function(){let t;t=dou.Event,t.CHANGING="changing",t.PROPERTY_CHANGE="propertyChange",t=dou2d.Event2D,t.ITEM_TAP="itemTap",t.RICH_TEXT_CHANGE="richTextChange",t=dou2d.TouchEvent,t.TOUCH_CANCEL="touchCancel"}(),function(t){!function(e){function i(t,e){for(let i in e)"prototype"!=i&&e.hasOwnProperty(i)&&(t[i]=e[i]);let i=t.prototype,n=e.prototype,a=Object.getOwnPropertyNames(n),o=a.length;for(let t=0;t<o;t++){let e=a[t];if("__meta__"!=e&&(!i.hasOwnProperty(e)||s(i,e))){let t=Object.getOwnPropertyDescriptor(n,e);Object.defineProperty(i,e,t)}}}function s(t,e){if("function"!=typeof t[e])return!1;let i=t[e].toString(),s=i.indexOf("{"),n=i.lastIndexOf("}");return i=i.substring(s+1,n),""==i.trim()}function n(t){return"douUI.sys.IUIComponent"===t.__interface_type__}function a(t,e){if(!t||"number"==typeof t)return t;let i=t,s=i.indexOf("%");return-1==s?+i:.01*+i.substring(0,s)*e}e.implementUIComponent=function(e,s,n){i(e,t.sys.UIComponentImpl);let a=e.prototype;a.$super=s.prototype,n&&(a.$childAdded=function(t,e){this.invalidateSize(),this.invalidateDisplayList()},a.$childRemoved=function(t,e){this.invalidateSize(),this.invalidateDisplayList()})},e.mixin=i,e.isIUIComponent=n,e.measure=function(t){if(!t)return;let e=0,i=0,s=dou.recyclable(dou2d.Rectangle),a=t.numChildren;for(let o=0;o<a;o++){let a=t.getChildAt(o);if(!n(a)||!a.includeInLayout)continue;let h,l,r=a.$UIComponent,d=+r[4],u=+r[5],c=+r[0],p=+r[1],_=+r[2],g=+r[3];a.getPreferredBounds(s),isNaN(c)||isNaN(p)?isNaN(d)?isNaN(c)&&isNaN(p)?h=s.x:(h=isNaN(c)?0:c,h+=isNaN(p)?0:p):h=2*Math.abs(d):h=c+p,isNaN(_)||isNaN(g)?isNaN(u)?isNaN(_)&&isNaN(g)?l=s.y:(l=isNaN(_)?0:_,l+=isNaN(g)?0:g):l=2*Math.abs(u):l=_+g;let m=s.width,I=s.height;e=Math.ceil(Math.max(e,h+m)),i=Math.ceil(Math.max(i,l+I))}t.setMeasuredSize(e,i)},e.updateDisplayList=function(t,e,i){if(!t)return;let s=t.numChildren,o=0,h=0,l=dou.recyclable(dou2d.Rectangle);for(let r=0;r<s;r++){let s=t.getChildAt(r);if(!n(s)||!s.includeInLayout)continue;let d=s.$UIComponent,u=a(d[4],.5*e),c=a(d[5],.5*i),p=a(d[0],e),_=a(d[1],e),g=a(d[2],i),m=a(d[3],i),I=d[6],v=d[7],y=NaN,C=NaN;isNaN(p)||isNaN(_)?isNaN(I)||(y=Math.round(e*Math.min(.01*I,1))):y=e-_-p,isNaN(g)||isNaN(m)?isNaN(v)||(C=Math.round(i*Math.min(.01*v,1))):C=i-m-g,s.setLayoutBoundsSize(y,C),s.getLayoutBounds(l);let f=l.width,E=l.height,x=NaN,S=NaN;x=isNaN(u)?isNaN(p)?isNaN(_)?l.x:e-f-_:p:Math.round((e-f)/2+u),S=isNaN(c)?isNaN(g)?isNaN(m)?l.y:i-E-m:g:Math.round((i-E)/2+c),s.setLayoutBoundsPosition(x,S),o=Math.max(o,x+f),h=Math.max(h,S+E)}return l.recycle(),dou.recyclable(dou2d.Point).set(o,h)}}(t.sys||(t.sys={}))}(douUI||(douUI={})),function(t){t.DefaultAssetAdapter=class{getAsset(t,e,i){dou2d.asset.hasRes(t)?dou2d.asset.loadRes(t,0,e,i):dou.loader.load(t,e,i)}}}(douUI||(douUI={})),function(t){t.getAsset=function(t,e,i){dou2d.getImplementation("AssetAdapter").getAsset(t,e,i)},dou2d.registerImplementation("AssetAdapter",new t.DefaultAssetAdapter)}(douUI||(douUI={})),function(t){class e extends dou.EventDispatcher{constructor(t){super(),this._source=t||[]}set source(e){e||(e=[]),this._source=e,this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,4)}get source(){return this._source}get length(){return this._source.length}addItem(e){this._source.push(e),this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,0,this._source.length-1,-1,[e])}addItemAt(e,i){(i<0||i>this._source.length)&&console.error("索引不在范围内"),this._source.splice(i,0,e),this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,0,i,-1,[e])}getItemAt(t){return this._source[t]}getItemIndex(t){let e=this._source.length;for(let i=0;i<e;i++)if(this._source[i]===t)return i;return-1}itemUpdated(e){let i=this.getItemIndex(e);-1!=i&&this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,5,i,-1,[e])}replaceItemAt(e,i){if(i<0||i>=this._source.length)return void console.error("索引不在范围内");let s=this._source.splice(i,1,e)[0];return this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,3,i,-1,[e],[s]),s}replaceAll(t){t||(t=[]);let e=t.length,i=this._source.length;for(let t=e;t<i;t++)this.removeItemAt(e);for(let s=0;s<e;s++)s>=i?this.addItemAt(t[s],s):this.replaceItemAt(t[s],s);this._source=t}removeItemAt(e){if(e<0||e>=this._source.length)return void console.error("索引不在范围内");let i=this._source.splice(e,1)[0];return this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,2,e,-1,[i]),i}removeAll(){let e=this._source.concat();this._source=[],this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,2,0,-1,e)}refresh(){this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,1)}}t.ArrayCollection=e}(douUI||(douUI={})),function(t){!function(t){class e extends dou.EventDispatcher{constructor(){super(...arguments),this._targetLevel=Number.POSITIVE_INFINITY,this._invalidatePropertiesFlag=!1,this._invalidateClientPropertiesFlag=!1,this._invalidatePropertiesQueue=new i,this._invalidateSizeFlag=!1,this._invalidateClientSizeFlag=!1,this._invalidateSizeQueue=new i,this._invalidateDisplayListFlag=!1,this._invalidateDisplayListQueue=new i,this._eventDisplay=new dou2d.Bitmap,this._listenersAttached=!1}invalidateProperties(t){this._invalidatePropertiesFlag||(this._invalidatePropertiesFlag=!0,this._listenersAttached||this.attachListeners()),this._targetLevel<=t.$nestLevel&&(this._invalidateClientPropertiesFlag=!0),this._invalidatePropertiesQueue.insert(t)}validateProperties(){let t=this._invalidatePropertiesQueue,e=t.shift();for(;e;)e.stage&&e.validateProperties(),e=t.shift();t.isEmpty()&&(this._invalidatePropertiesFlag=!1)}invalidateSize(t){this._invalidateSizeFlag||(this._invalidateSizeFlag=!0,this._listenersAttached||this.attachListeners()),this._targetLevel<=t.$nestLevel&&(this._invalidateClientSizeFlag=!0),this._invalidateSizeQueue.insert(t)}validateSize(){let t=this._invalidateSizeQueue,e=t.pop();for(;e;)e.stage&&e.validateSize(),e=t.pop();t.isEmpty()&&(this._invalidateSizeFlag=!1)}invalidateDisplayList(t){this._invalidateDisplayListFlag||(this._invalidateDisplayListFlag=!0,this._listenersAttached||this.attachListeners()),this._invalidateDisplayListQueue.insert(t)}validateDisplayList(){let t=this._invalidateDisplayListQueue,e=t.shift();for(;e;)e.stage&&e.validateDisplayList(),e=t.shift();t.isEmpty()&&(this._invalidateDisplayListFlag=!1)}attachListeners(){this._eventDisplay.on(dou2d.Event2D.ENTER_FRAME,this.doPhasedInstantiationCallBack,this),this._eventDisplay.on(dou2d.Event2D.RENDER,this.doPhasedInstantiationCallBack,this),dou2d.$2d.stage.invalidate(),this._listenersAttached=!0}doPhasedInstantiationCallBack(t){this._eventDisplay.off(dou2d.Event2D.ENTER_FRAME,this.doPhasedInstantiationCallBack,this),this._eventDisplay.off(dou2d.Event2D.RENDER,this.doPhasedInstantiationCallBack,this),this.doPhasedInstantiation()}doPhasedInstantiation(){this._invalidatePropertiesFlag&&this.validateProperties(),this._invalidateSizeFlag&&this.validateSize(),this._invalidateDisplayListFlag&&this.validateDisplayList(),this._invalidatePropertiesFlag||this._invalidateSizeFlag||this._invalidateDisplayListFlag?this.attachListeners():this._listenersAttached=!1}validateClient(t){let e,i=!1,s=this._targetLevel;this._targetLevel===Number.POSITIVE_INFINITY&&(this._targetLevel=t.$nestLevel);let n=this._invalidatePropertiesQueue,a=this._invalidateSizeQueue,o=this._invalidateDisplayListQueue;for(;!i;){for(i=!0,e=n.removeSmallestChild(t);e;)e.stage&&e.validateProperties(),e=n.removeSmallestChild(t);for(n.isEmpty()&&(this._invalidatePropertiesFlag=!1),this._invalidateClientPropertiesFlag=!1,e=a.removeLargestChild(t);e;){if(e.stage&&e.validateSize(),this._invalidateClientPropertiesFlag&&(e=n.removeSmallestChild(t),e)){n.insert(e),i=!1;break}e=a.removeLargestChild(t)}for(a.isEmpty()&&(this._invalidateSizeFlag=!1),this._invalidateClientPropertiesFlag=!1,this._invalidateClientSizeFlag=!1,e=o.removeSmallestChild(t);e;){if(e.stage&&e.validateDisplayList(),this._invalidateClientPropertiesFlag&&(e=n.removeSmallestChild(t),e)){n.insert(e),i=!1;break}if(this._invalidateClientSizeFlag&&(e=a.removeLargestChild(t),e)){a.insert(e),i=!1;break}e=o.removeSmallestChild(t)}o.isEmpty()&&(this._invalidateDisplayListFlag=!1)}s===Number.POSITIVE_INFINITY&&(this._targetLevel=Number.POSITIVE_INFINITY)}}t.Validator=e;class i{constructor(){this.minDepth=0,this.maxDepth=-1,this.depthBins={}}insert(t){let e=t.$nestLevel;this.maxDepth<this.minDepth?this.minDepth=this.maxDepth=e:(e<this.minDepth&&(this.minDepth=e),e>this.maxDepth&&(this.maxDepth=e));let i=this.depthBins[e];i||(i=this.depthBins[e]=new s),i.insert(t)}pop(){let t,e=this.minDepth;if(e<=this.maxDepth){let i=this.depthBins[this.maxDepth];for(;!i||0===i.length;){if(this.maxDepth--,this.maxDepth<e)return null;i=this.depthBins[this.maxDepth]}for(t=i.pop();!(i&&0!=i.length||(this.maxDepth--,this.maxDepth<e));)i=this.depthBins[this.maxDepth]}return t}shift(){let t,e=this.maxDepth;if(this.minDepth<=e){let i=this.depthBins[this.minDepth];for(;!i||0===i.length;){if(this.minDepth++,this.minDepth>e)return null;i=this.depthBins[this.minDepth]}for(t=i.pop();!(i&&0!=i.length||(this.minDepth++,this.minDepth>e));)i=this.depthBins[this.minDepth]}return t}removeLargestChild(t){let e=t.$nestLevel,i=this.maxDepth,s=e;for(;s<=i;){let n=this.depthBins[i];if(n&&n.length>0){if(i===e){if(n.map.has(t))return n.remove(t),t}else{if(!(t instanceof dou2d.DisplayObjectContainer))break;{let e=n.items,i=n.length;for(let s=0;s<i;s++){let i=e[s];if(t.contains(i))return n.remove(i),i}}}i--}else if(i==this.maxDepth&&this.maxDepth--,i--,i<s)break}return null}removeSmallestChild(t){let e=t.$nestLevel,i=e,s=this.maxDepth;for(;i<=s;){let n=this.depthBins[i];if(n&&n.length>0){if(i===e){if(n.map.has(t))return n.remove(t),t}else{if(!(t instanceof dou2d.DisplayObjectContainer))break;{let e=n.items,i=n.length;for(let s=0;s<i;s++){let i=e[s];if(t.contains(i))return n.remove(i),i}}}i++}else if(i==this.minDepth&&this.minDepth++,i++,i>s)break}return null}isEmpty(){return this.minDepth>this.maxDepth}}class s{constructor(){this.length=0,this.map=new Map,this.items=[]}insert(t){this.map.has(t)||(this.map.set(t,!0),this.length++,this.items.push(t))}pop(){let t=this.items.pop();return t&&(this.length--,0===this.length?this.map.clear():this.map.set(t,!1)),t}remove(t){let e=this.items.indexOf(t);e>=0&&(this.items.splice(e,1),this.length--,0===this.length?this.map.clear():this.map.set(t,!1))}}}(t.sys||(t.sys={}))}(douUI||(douUI={})),function(t){!function(e){const i=new e.Validator,s=new dou2d.Matrix;class n extends dou2d.DisplayObject{constructor(){super(),this.__interface_type__="douUI.sys.IUIComponent",this.initializeUIValues()}$setWidth(t){t=+t;let e=this.$UIComponent;return!(t<0||e[10]===t&&e[8]===t)&&(e[8]=t,isNaN(t)&&this.invalidateSize(),this.invalidateProperties(),this.invalidateDisplayList(),this.invalidateParentLayout(),!0)}$getWidth(){return this.validateSizeNow(),this.$UIComponent[10]}$setHeight(t){t=+t;let e=this.$UIComponent;return!(t<0||e[11]===t&&e[9]===t)&&(e[9]=t,isNaN(t)&&this.invalidateSize(),this.invalidateProperties(),this.invalidateDisplayList(),this.invalidateParentLayout(),!0)}$getHeight(){return this.validateSizeNow(),this.$UIComponent[11]}set left(t){t=t&&"number"!=typeof t?t.toString().trim():+t;let e=this.$UIComponent;e[0]!==t&&(e[0]=t,this.invalidateParentLayout())}get left(){return this.$UIComponent[0]}set right(t){t=t&&"number"!=typeof t?t.toString().trim():+t;let e=this.$UIComponent;e[1]!==t&&(e[1]=t,this.invalidateParentLayout())}get right(){return this.$UIComponent[1]}set top(t){t=t&&"number"!=typeof t?t.toString().trim():+t;let e=this.$UIComponent;e[2]!==t&&(e[2]=t,this.invalidateParentLayout())}get top(){return this.$UIComponent[2]}set bottom(t){t=t&&"number"!=typeof t?t.toString().trim():+t;let e=this.$UIComponent;e[3]!=t&&(e[3]=t,this.invalidateParentLayout())}get bottom(){return this.$UIComponent[3]}set horizontalCenter(t){t=t&&"number"!=typeof t?t.toString().trim():+t;let e=this.$UIComponent;e[4]!==t&&(e[4]=t,this.invalidateParentLayout())}get horizontalCenter(){return this.$UIComponent[4]}set verticalCenter(t){t=t&&"number"!=typeof t?t.toString().trim():+t;let e=this.$UIComponent;e[5]!==t&&(e[5]=t,this.invalidateParentLayout())}get verticalCenter(){return this.$UIComponent[5]}set percentWidth(t){t=+t;let e=this.$UIComponent;e[6]!==t&&(e[6]=t,this.invalidateParentLayout())}get percentWidth(){return this.$UIComponent[6]}set percentHeight(t){t=+t;let e=this.$UIComponent;e[7]!==t&&(e[7]=t,this.invalidateParentLayout())}get percentHeight(){return this.$UIComponent[7]}get explicitWidth(){return this.$UIComponent[8]}get explicitHeight(){return this.$UIComponent[9]}set minWidth(t){t=+t||0;let e=this.$UIComponent;t<0||e[12]===t||(e[12]=t,this.invalidateSize(),this.invalidateParentLayout())}get minWidth(){return this.$UIComponent[12]}set maxWidth(t){t=+t||0;let e=this.$UIComponent;t<0||e[13]===t||(e[13]=t,this.invalidateSize(),this.invalidateParentLayout())}get maxWidth(){return this.$UIComponent[13]}set minHeight(t){t=+t||0;let e=this.$UIComponent;t<0||e[14]===t||(e[14]=t,this.invalidateSize(),this.invalidateParentLayout())}get minHeight(){return this.$UIComponent[14]}set maxHeight(t){t=+t||0;let e=this.$UIComponent;t<0||e[15]===t||(e[15]=t,this.invalidateSize(),this.invalidateParentLayout())}get maxHeight(){return this.$UIComponent[15]}initializeUIValues(){this.$UIComponent={0:NaN,1:NaN,2:NaN,3:NaN,4:NaN,5:NaN,6:NaN,7:NaN,8:NaN,9:NaN,10:0,11:0,12:0,13:1e5,14:0,15:1e5,16:0,17:0,18:NaN,19:NaN,20:0,21:0,22:0,23:0,24:!0,25:!0,26:!0,27:!1,28:!1,29:!1},this.$includeInLayout=!0,this._touchEnabled=!0}createChildren(){}childrenCreated(){}commitProperties(){let e=this.$UIComponent;e[22]==e[10]&&e[23]==e[11]||(this.dispatchUIEvent(t.UIEvent.RESIZE),e[22]=e[10],e[23]=e[11]),e[20]==this.$getX()&&e[21]==this.$getY()||(this.dispatchUIEvent(t.UIEvent.MOVE),e[20]=this.$getX(),e[21]=this.$getY())}measure(){}updateDisplayList(t,e){}set includeInLayout(t){t=!!t,this.$includeInLayout!==t&&(this.$includeInLayout=!0,this.invalidateParentLayout(),this.$includeInLayout=t)}get includeInLayout(){return this.$includeInLayout}$onAddToStage(e,i){this.$super.$onAddToStage.call(this,e,i),this.checkInvalidateFlag();let s=this.$UIComponent;s[29]||(s[29]=!0,this.createChildren(),this.childrenCreated(),this.dispatchUIEvent(t.UIEvent.CREATION_COMPLETE))}checkInvalidateFlag(t){let e=this.$UIComponent;e[24]&&i.invalidateProperties(this),e[25]&&i.invalidateSize(this),e[26]&&i.invalidateDisplayList(this)}validateSizeNow(){this.validateSize(!0),this.updateFinalSize()}setMeasuredSize(t,e){let i=this.$UIComponent;i[16]=Math.ceil(+t||0),i[17]=Math.ceil(+e||0)}setActualSize(e,i){let s=!1,n=this.$UIComponent;n[10]!==e&&(n[10]=e,s=!0),n[11]!==i&&(n[11]=i,s=!0),s&&(this.invalidateDisplayList(),this.dispatchUIEvent(t.UIEvent.RESIZE))}$updateUseTransform(){this.$super.$updateUseTransform.call(this),this.invalidateParentLayout()}$setMatrix(t,e=!0){return this.$super.$setMatrix.call(this,t,e),this.invalidateParentLayout(),!0}$setAnchorOffsetX(t){return this.$super.$setAnchorOffsetX.call(this,t),this.invalidateParentLayout(),!0}$setAnchorOffsetY(t){return this.$super.$setAnchorOffsetY.call(this,t),this.invalidateParentLayout(),!0}$setX(t){let e=this.$super.$setX.call(this,t);return e&&(this.invalidateParentLayout(),this.invalidateProperties()),e}$setY(t){let e=this.$super.$setY.call(this,t);return e&&(this.invalidateParentLayout(),this.invalidateProperties()),e}invalidateProperties(){let t=this.$UIComponent;t[24]||(t[24]=!0,this._stage&&i.invalidateProperties(this))}validateProperties(){let t=this.$UIComponent;t[24]&&(this.commitProperties(),t[24]=!1)}invalidateSize(){let t=this.$UIComponent;t[25]||(t[25]=!0,this._stage&&i.invalidateSize(this))}validateSize(t){if(t){let t=this.$children;if(t){let i=t.length;for(let s=0;s<i;s++){let i=t[s];e.isIUIComponent(i)&&i.validateSize(!0)}}}let i=this.$UIComponent;if(i[25]){this.measureSizes()&&(this.invalidateDisplayList(),this.invalidateParentLayout()),i[25]=!1}}measureSizes(){let t=!1,e=this.$UIComponent;if(!e[25])return t;(isNaN(e[8])||isNaN(e[9]))&&(this.measure(),e[16]<e[12]&&(e[16]=e[12]),e[16]>e[13]&&(e[16]=e[13]),e[17]<e[14]&&(e[17]=e[14]),e[17]>e[15]&&(e[17]=e[15]));let i=this.getPreferredUWidth(),s=this.getPreferredUHeight();return i===e[18]&&s===e[19]||(e[18]=i,e[19]=s,t=!0),t}invalidateDisplayList(){let t=this.$UIComponent;t[26]||(t[26]=!0,this._stage&&i.invalidateDisplayList(this))}validateDisplayList(){let t=this.$UIComponent;t[26]&&(this.updateFinalSize(),this.updateDisplayList(t[10],t[11]),t[26]=!1)}updateFinalSize(){let t=0,e=0,i=this.$UIComponent;t=i[27]?i[10]:isNaN(i[8])?i[16]:i[8],e=i[28]?i[11]:isNaN(i[9])?i[17]:i[9],this.setActualSize(t,e)}validateNow(){this._stage&&i.validateClient(this)}invalidateParentLayout(){let t=this._parent;t&&this.$includeInLayout&&e.isIUIComponent(t)&&(t.invalidateSize(),t.invalidateDisplayList())}setLayoutBoundsSize(t,i){if(t=+t,(i=+i)<0||t<0)return;let s,n,a=this.$UIComponent,o=a[13],h=a[15],l=Math.min(a[12],o),r=Math.min(a[14],h);isNaN(t)?(a[27]=!1,s=this.getPreferredUWidth()):(a[27]=!0,s=Math.max(l,Math.min(o,t))),isNaN(i)?(a[28]=!1,n=this.getPreferredUHeight()):(a[28]=!0,n=Math.max(r,Math.min(h,i)));let d=this.getAnchorMatrix();if(e.MatrixUtil.isDeltaIdentity(d))return void this.setActualSize(s,n);let u=e.MatrixUtil.fitBounds(t,i,d,a[8],a[9],this.getPreferredUWidth(),this.getPreferredUHeight(),l,r,o,h);u||(u=dou.recyclable(dou2d.Point),u.set(l,r)),this.setActualSize(u.x,u.y),u.recycle()}setLayoutBoundsPosition(i,s){let n=this.$getMatrix();if(!e.MatrixUtil.isDeltaIdentity(n)||0!=this.anchorOffsetX||0!=this.anchorOffsetY){let t=dou.recyclable(dou2d.Rectangle);this.getLayoutBounds(t),i+=this.$getX()-t.x,s+=this.$getY()-t.y,t.recycle()}let a=this.$super.$setX.call(this,i);(this.$super.$setY.call(this,s)||a)&&this.dispatchUIEvent(t.UIEvent.MOVE)}getLayoutBounds(t){let e,i,s=this.$UIComponent;e=s[27]?s[10]:isNaN(s[8])?s[16]:s[8],i=s[28]?s[11]:isNaN(s[9])?s[17]:s[9],this.applyMatrix(t,e,i)}getPreferredUWidth(){let t=this.$UIComponent;return isNaN(t[8])?t[16]:t[8]}getPreferredUHeight(){let t=this.$UIComponent;return isNaN(t[9])?t[17]:t[9]}getPreferredBounds(t){let e=this.getPreferredUWidth(),i=this.getPreferredUHeight();this.applyMatrix(t,e,i)}applyMatrix(t,i,s){t.set(0,0,i,s);let n=this.getAnchorMatrix();e.MatrixUtil.isDeltaIdentity(n)?(t.x+=n.tx,t.y+=n.ty):n.transformBounds(t)}getAnchorMatrix(){let t=this.$getMatrix(),e=this.anchorOffsetX,i=this.anchorOffsetY;if(0!=e||0!=i){let n=s;return n.set(1,0,0,1,-e,-i),n.premultiply(t),n}return t}}e.UIComponentImpl=n}(t.sys||(t.sys={}))}(douUI||(douUI={})),function(t){class e extends dou2d.DisplayObjectContainer{constructor(){super(),this.__interface_type__="douUI.sys.IUIComponent",this.initializeUIValues(),this.$Component={0:!0,1:!0,2:!0,3:null,4:null,5:!1,6:null,7:!1,8:[]},this._touchEnabled=!0}set enabled(t){t=!!t;let e=this.$Component;t!==e[0]&&(e[0]=t,t?(this._touchEnabled=e[2],this._touchChildren=e[1]):(this._touchEnabled=!1,this._touchChildren=!1),this.invalidateState())}get enabled(){return this.$Component[0]}$setTouchChildren(t){t=!!t;let e=this.$Component;return e[1]=t,!e[0]||(e[1]=t,super.$setTouchChildren(t))}$setTouchEnabled(t){t=!!t;let e=this.$Component;e[2]=t,e[0]&&super.$setTouchEnabled(t)}set skin(t){let e=this.$Component;if(e[3]==t)return;let i=e[3];i&&(i.onUnload(),this.onSkinRemoved()),e[3]=t,t&&(this._stage?(t.onCreateSkin(),t.onApply(),this.onSkinAdded()):e[5]=!0,e[7]=!0,this.invalidateProperties())}get skin(){return this.$Component[3]}set skinName(e){let i=this.$Component;if(i[4]==e)return;if(!e)return;i[4]=e;let s=t.Theme.getSkin(e);if(!s)throw new Error(`没有注册对应的皮肤类: ${e}`);this.skin=new s}get skinName(){return this.$Component[4]}set currentState(t){let e=this.$Component;e[6]!=t&&(e[6]=t,this.invalidateState())}get currentState(){let t=this.$Component;return t[6]?t[6]:this.getCurrentState()}invalidateState(){let t=this.$Component;t[7]||(t[7]=!0,this.invalidateProperties())}getCurrentState(){return""}setStyle(t,...e){if(this.$UIComponent[29])this.skin&&"function"==typeof this.skin[t]&&this.skin[t].call(this.skin,...e);else{this.$Component[8].push([t,e])}}onSkinAdded(){}onSkinRemoved(){}initializeUIValues(){}createChildren(){let e=this.$Component;if(!e[3]){let e=t.Theme.getDefaultSkin(this.constructor);if(!e)throw new Error(`没有注册默认的皮肤类: ${this.constructor}`);this.skin=new e(this)}if(e[5]){e[5]=!1;let t=this.skin;t.onCreateSkin(),t.onApply(),this.onSkinAdded()}let i=e[8];if(i.length>0){for(let t of i)this.skin[t[0]].call(this.skin,...t[1]);i.length=0}}childrenCreated(){}commitProperties(){t.sys.UIComponentImpl.prototype.commitProperties.call(this);let e=this.$Component;if(e[5]){e[5]=!1;let t=this.skin;t.onCreateSkin(),t.onApply(),this.onSkinAdded()}e[7]&&(e[7]=!1,e[3]&&e[3].setState(this.currentState))}measure(){t.sys.measure(this);let e=this.$Component[3];if(!e)return;let i=this.$UIComponent;isNaN(e.width)?(i[16]<e.minWidth&&(i[16]=e.minWidth),i[16]>e.maxWidth&&(i[16]=e.maxWidth)):i[16]=e.width,isNaN(e.height)?(i[17]<e.minHeight&&(i[17]=e.minHeight),i[17]>e.maxHeight&&(i[17]=e.maxHeight)):i[17]=e.height}updateDisplayList(e,i){t.sys.updateDisplayList(this,e,i)}invalidateParentLayout(){}setMeasuredSize(t,e){}invalidateProperties(){}validateProperties(){}invalidateSize(){}validateSize(t){}invalidateDisplayList(){}validateDisplayList(){}validateNow(){}setLayoutBoundsSize(t,e){}setLayoutBoundsPosition(t,e){}getLayoutBounds(t){}getPreferredBounds(t){}}t.Component=e,t.sys.implementUIComponent(e,dou2d.DisplayObjectContainer,!0)}(douUI||(douUI={})),function(t){!function(t){t.Animation=class{constructor(t,e,i){this._isPlaying=!1,this._updateFunction=t,this._endFunction=e,this._thisObject=i}get isPlaying(){return this._isPlaying}get currentValue(){return this._currentValue}play(t,e,i,s=dou.Ease.sineInOut){this._duration=t,this._from=e,this._to=i,this._easerFunction=s,this.stop(),this.start()}start(){this._isPlaying=!1,this._currentValue=0,this._runningTime=0,this.update(0),dou2d.$2d.ticker.startTick(this.update,this)}update(t){this._runningTime+=t,this._isPlaying||(this._isPlaying=!0);let e=this._duration,i=0==e?1:Math.min(this._runningTime,e)/e;this._easerFunction&&(i=this._easerFunction(i)),this._currentValue=this._from+(this._to-this._from)*i,this._updateFunction&&this._updateFunction.call(this._thisObject,this);let s=this._runningTime>=e;return s&&this.stop(),s&&this._endFunction&&this._endFunction.call(this._thisObject,this),!0}stop(){this._isPlaying=!1,this._runningTime=0,dou2d.$2d.ticker.stopTick(this.update,this)}}}(t.sys||(t.sys={}))}(douUI||(douUI={})),function(t){class e extends t.Component{constructor(){super(),this.$Range={0:100,1:!1,2:0,3:!1,4:0,5:0,6:!1,7:1,8:!1,9:!1}}set maximum(t){t=+t||0;let e=this.$Range;t!==e[0]&&(e[0]=t,e[1]=!0,this.invalidateProperties(),this.invalidateDisplayList())}get maximum(){return this.$Range[0]}set minimum(t){t=+t||0;let e=this.$Range;t!==e[2]&&(e[2]=t,e[3]=!0,this.invalidateProperties(),this.invalidateDisplayList())}get minimum(){return this.$Range[2]}set value(t){if((t=+t||0)===this.value)return;let e=this.$Range;e[5]=t,e[6]=!0,this.invalidateProperties()}get value(){let t=this.$Range;return t[6]?t[5]:t[4]}set snapInterval(t){let e=this.$Range;e[9]=!0,(t=+t||0)!==e[7]&&(isNaN(t)?(e[7]=1,e[9]=!1):e[7]=t,e[8]=!0,this.invalidateProperties())}get snapInterval(){return this.$Range[7]}commitProperties(){super.commitProperties();let t=this.$Range;if(t[2]>t[0]&&(t[1]?t[0]=t[2]:t[2]=t[0]),t[6]||t[1]||t[3]||t[8]){let e=t[6]?t[5]:t[4];t[6]=!1,t[1]=!1,t[3]=!1,t[8]=!1,this.setValue(this.nearestValidValue(e,t[7]))}}setValue(t){let e=this.$Range;e[4]!==t&&(e[0]>e[2]?e[4]=Math.min(e[0],Math.max(e[2],t)):e[4]=t,e[6]=!1,this.invalidateDisplayList(),this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"value"))}nearestValidValue(t,e){let i=this.$Range;if(0==e)return Math.max(i[2],Math.min(i[0],t));let s=i[0]-i[2],n=1;if(t-=i[2],e!=Math.round(e)){let i=(1+e).toString().split(".");n=Math.pow(10,i[1].length),s*=n,t=Math.round(t*n),e=Math.round(e*n)}let a=Math.max(0,Math.floor(t/e)*e),o=Math.min(s,Math.floor((t+e)/e)*e);return(t-a>=(o-a)/2?o:a)/n+i[2]}updateDisplayList(t,e){super.updateDisplayList(t,e),this.updateSkinDisplayList()}updateSkinDisplayList(){}}t.Range=e}(douUI||(douUI={})),function(t){class e extends t.Component{constructor(){super(...arguments),this.autoVisibility=!0}set viewport(t){if(t==this._viewport)return;let e=this._viewport;e&&(e.off(dou.Event.PROPERTY_CHANGE,this.onPropertyChanged,this),e.off(dou2d.Event2D.RESIZE,this.onViewportResize,this)),this._viewport=t,t&&(t.on(dou.Event.PROPERTY_CHANGE,this.onPropertyChanged,this),t.on(dou2d.Event2D.RESIZE,this.onViewportResize,this)),this.invalidateDisplayList()}get viewport(){return this._viewport}onViewportResize(t){this.invalidateDisplayList()}onPropertyChanged(t){}}t.ScrollBarBase=e}(douUI||(douUI={})),function(t){class e extends t.Range{constructor(){super(),this.$SliderBase={0:0,1:0,2:0,3:0,4:null,5:0,6:0,7:!0},this.maximum=10,this.on(dou2d.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)}set liveDragging(t){this.$SliderBase[7]=!!t}get liveDragging(){return this.$SliderBase[7]}set pendingValue(t){t=+t||0;let e=this.$SliderBase;t!==e[5]&&(e[5]=t,this.invalidateDisplayList())}get pendingValue(){return this.$SliderBase[5]}onSkinAdded(){this.thumb.on(dou2d.TouchEvent.TOUCH_BEGIN,this.onThumbTouchBegin,this),this.track.on(dou2d.TouchEvent.TOUCH_BEGIN,this.onTrackTouchBegin,this),this.trackHighlight.touchEnabled=!1,this.trackHighlight instanceof dou2d.DisplayObjectContainer&&(this.trackHighlight.touchChildren=!1)}onSkinRemoved(){this.thumb.off(dou2d.TouchEvent.TOUCH_BEGIN,this.onThumbTouchBegin,this),this.track.off(dou2d.TouchEvent.TOUCH_BEGIN,this.onTrackTouchBegin,this)}onTouchBegin(t){this._stage.on(dou2d.TouchEvent.TOUCH_END,this.stageTouchEndHandler,this),this.$SliderBase[4]=t.target}stageTouchEndHandler(t){let e=t.target,i=this.$SliderBase;t.currentTarget.off(dou2d.TouchEvent.TOUCH_END,this.stageTouchEndHandler,this),i[4]!=e&&this.contains(e)&&this.dispatchTouchEvent(dou2d.TouchEvent.TOUCH_TAP,t.stageX,t.stageY,t.touchPointID,!1,!0,!0),i[4]=null}setValue(t){this.$SliderBase[5]=t,super.setValue(t)}pointToValue(t,e){return this.minimum}onThumbTouchBegin(e){let i=this.$SliderBase,s=this._stage;s.on(dou2d.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),s.on(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this);let n=dou.recyclable(dou2d.Point),a=this.thumb.globalToLocal(e.stageX,e.stageY,n);i[0]=a.x,i[1]=a.y,n.recycle(),this.dispatchUIEvent(t.UIEvent.CHANGE_START)}onStageTouchMove(t){let e=this.$SliderBase;e[2]=t.stageX,e[3]=t.stageY;let i=this.track;if(!i)return;let s=dou.recyclable(dou2d.Point),n=i.globalToLocal(e[2],e[3],s),a=this.pointToValue(n.x-e[0],n.y-e[1]);s.recycle(),a=this.nearestValidValue(a,this.snapInterval),this.updateWhenTouchMove(a),t.updateAfterEvent()}updateWhenTouchMove(t){t!=this.$SliderBase[5]&&(this.liveDragging?(this.setValue(t),this.dispatchEvent(dou.Event.CHANGE)):this.pendingValue=t)}onStageTouchEnd(e){let i=e.currentTarget;i.off(dou2d.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),i.off(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.dispatchUIEvent(t.UIEvent.CHANGE_END);let s=this.$SliderBase;this.liveDragging||this.value==s[5]||(this.setValue(s[5]),this.dispatchEvent(dou.Event.CHANGE))}onTrackTouchBegin(t){let e=this.thumb?this.thumb.width:0,i=this.thumb?this.thumb.height:0,s=t.stageX-e/2,n=t.stageY-i/2,a=dou.recyclable(dou2d.Point),o=this.track.globalToLocal(s,n,a),h=this.$Range,l=this.pointToValue(o.x,o.y);a.recycle(),l=this.nearestValidValue(l,h[7]),l!=this.$SliderBase[5]&&(this.setValue(l),this.dispatchEvent(dou.Event.CHANGE))}}t.SliderBase=e}(douUI||(douUI={})),function(t){!function(t){t.TouchScroll=class{constructor(e,i,s){this.scrollFactor=1,this._started=!0,this._bounces=!0,this._updateFunction=i,this._endFunction=s,this._target=e,this._previousVelocity=[],this._animation=new t.Animation(this.onScrollingUpdate,this.finishScrolling,this)}set bounces(t){this._bounces=t}get bounces(){return this._bounces}get isStarted(){return this._started}get isPlaying(){return this._animation.isPlaying}onScrollingUpdate(t){this._currentScrollPos=t.currentValue,this._updateFunction.call(this._target,t.currentValue)}start(t){this._started=!0,this._velocity=0,this._previousVelocity.length=0,this._previousPosition=this._currentPosition=t,this._offsetPoint=t,dou2d.$2d.ticker.startTick(this.onTick,this)}onTick(t){let i=this._previousVelocity;return i.length>=e&&i.shift(),this._velocity=(this._currentPosition-this._previousPosition)/t,i.push(this._velocity),this._previousPosition=this._currentPosition,!0}update(t,e,i){e=Math.max(e,0),this._currentPosition=t,this._maxScrollPos=e;let s=this._offsetPoint-t,n=s+i;this._offsetPoint=t,n<0&&(this._bounces?n-=.5*s:n=0),n>e&&(this._bounces?n-=.5*s:n=e),this._currentScrollPos=n,this._updateFunction.call(this._target,n)}finish(t,e){dou2d.$2d.ticker.stopTick(this.onTick,this),this._started=!1;let l=this._velocity*s,r=this._previousVelocity,d=r.length,u=s;for(let t=0;t<d;t++){let e=i[t];l+=r[0]*e,u+=e}let c=l/u,p=Math.abs(c),_=0,g=0;if(p>n)if(g=t+(c-n)/h*2*this.scrollFactor,g<0||g>e)for(g=t;Math.abs(c)>n;)g-=c,c*=g<0||g>e?a*o:a,_++;else _=Math.log(n/p)/h;else g=t;_>0?(this._bounces||(g<0?g=0:g>e&&(g=e)),this.throwTo(g,_)):this.finishScrolling()}finishScrolling(t){let e=this._currentScrollPos,i=this._maxScrollPos,s=e;e<0&&(s=0),e>i&&(s=i),this.throwTo(s,300)}throwTo(t,e=500){let i=this._currentScrollPos;i!=t?this._animation.play(e,i,t,l):this._endFunction.call(this._target)}stop(){this._started=!1,this._animation.stop(),dou2d.$2d.ticker.stopTick(this.onTick,this)}};const e=4,i=[1,1.33,1.66,2],s=2.33,n=.02,a=.998,o=.95,h=Math.log(a);function l(t){let e=t-1;return e*e*e+1}}(t.sys||(t.sys={}))}(douUI||(douUI={})),function(t){class e extends dou2d.TextField{constructor(t){super(),this._widthConstraint=NaN,this.__interface_type__="douUI.sys.IUIComponent",this.initializeUIValues(),this.text=t}$invalidateTextField(){super.$invalidateTextField(),this.invalidateSize()}$setWidth(e){let i=super.$setWidth(e),s=t.sys.UIComponentImpl.prototype.$setWidth.call(this,e);return i&&s}$setHeight(e){let i=super.$setHeight(e),s=t.sys.UIComponentImpl.prototype.$setHeight.call(this,e);return i&&s}$setText(t){let e=super.$setText(t);return this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"text"),e}initializeUIValues(){}createChildren(){}childrenCreated(){}commitProperties(){}measure(){let t=this.$UIComponent,e=this.$propertyMap[3],i=NaN;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(i=t[13]):i=t[8]:(i=this._widthConstraint,this._widthConstraint=NaN),super.$setWidth(i),this.setMeasuredSize(this.textWidth,this.textHeight),super.$setWidth(e)}updateDisplayList(t,e){super.$setWidth(t),super.$setHeight(e)}invalidateParentLayout(){}setMeasuredSize(t,e){}invalidateProperties(){}validateProperties(){}invalidateSize(){}validateSize(t){}invalidateDisplayList(){}validateDisplayList(){}validateNow(){}setLayoutBoundsSize(e,i){if(t.sys.UIComponentImpl.prototype.setLayoutBoundsSize.call(this,e,i),isNaN(e)||e===this._widthConstraint||0==e)return void(this._widthConstraint=e);this._widthConstraint=e;let s=this.$UIComponent;isNaN(s[9])&&e!=s[16]&&this.invalidateSize()}setLayoutBoundsPosition(t,e){}getLayoutBounds(t){}getPreferredBounds(t){}}t.Label=e,t.sys.implementUIComponent(e,dou2d.TextField)}(douUI||(douUI={})),function(t){class e extends dou2d.BitmapText{constructor(t){super(),this._widthConstraint=NaN,this._heightConstraint=NaN,this._sourceChanged=!1,this.__interface_type__="douUI.sys.IUIComponent",this.initializeUIValues(),this.text=t}$setWidth(e){let i=super.$setWidth(e),s=t.sys.UIComponentImpl.prototype.$setWidth.call(this,e);return i&&s}$setHeight(e){let i=super.$setHeight(e),s=t.sys.UIComponentImpl.prototype.$setHeight.call(this,e);return i&&s}$setText(t){let e=super.$setText(t);return this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"text"),e}set source(t){this._source!=t&&(this._source=t,this._stage?this.parseFont():(this._sourceChanged=!0,this.invalidateProperties()))}get source(){return this._source}$invalidateContentBounds(){super.$invalidateContentBounds(),this.invalidateSize()}parseFont(){t.getAsset(this._source,(t,e)=>{t&&this._source==e&&(this.$setFont(t),this._sourceChanged=!1)},this)}initializeUIValues(){}createChildren(){this._sourceChanged&&this.parseFont()}childrenCreated(){}commitProperties(){t.sys.UIComponentImpl.prototype.commitProperties.call(this),this._sourceChanged&&this.parseFont()}measure(){let t=this.$UIComponent,e=this._textFieldWidth,i=this._textFieldHeight,s=NaN;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(s=t[13]):s=t[8]:(s=this._widthConstraint,this._widthConstraint=NaN),super.$setWidth(s);let n=NaN;isNaN(this._heightConstraint)?isNaN(t[9])?1e5!=t[15]&&(n=t[15]):n=t[9]:(n=this._heightConstraint,this._heightConstraint=NaN),super.$setHeight(n),this.setMeasuredSize(this.textWidth,this.textHeight),super.$setWidth(e),super.$setHeight(i)}updateDisplayList(t,e){super.$setWidth(t),super.$setHeight(e)}invalidateParentLayout(){}setMeasuredSize(t,e){}invalidateProperties(){}validateProperties(){}invalidateSize(){}validateSize(t){}invalidateDisplayList(){}validateDisplayList(){}validateNow(){}setLayoutBoundsSize(e,i){if(t.sys.UIComponentImpl.prototype.setLayoutBoundsSize.call(this,e,i),isNaN(e)||e===this._widthConstraint||0==e)return;let s=this.$UIComponent;isNaN(s[9])&&e!=s[16]&&(this._widthConstraint=e,this._heightConstraint=i,this.invalidateSize())}setLayoutBoundsPosition(t,e){}getLayoutBounds(t){}getPreferredBounds(t){}}t.BitmapLabel=e,t.sys.implementUIComponent(e,dou2d.BitmapText)}(douUI||(douUI={})),function(t){class e extends dou2d.TextField{constructor(){super(),this._widthConstraint=NaN,this._isShowPrompt=!1,this._promptColor=6710886,this._isFocusIn=!1,this._isTouchCancle=!1,this.__interface_type__="douUI.sys.IUIComponent",this.initializeUIValues(),this.type=1,this.$EditableText={0:null,1:16777215,2:!1}}set prompt(t){let e=this.$EditableText,i=e[0];if(i==t)return;e[0]=t;let s=this.text;s&&s!=i||this.showPromptText()}get prompt(){return this.$EditableText[0]}set promptColor(t){if(t=0|+t,this._promptColor!=t){this._promptColor=t;let e=this.text;e&&e!=this.$EditableText[0]||this.showPromptText()}}get promptColor(){return this._promptColor}$invalidateTextField(){super.$invalidateTextField(),this.invalidateSize()}$setWidth(e){let i=super.$setWidth(e),s=t.sys.UIComponentImpl.prototype.$setWidth.call(this,e);return i&&s}$setHeight(e){let i=super.$setHeight(e),s=t.sys.UIComponentImpl.prototype.$setHeight.call(this,e);return i&&s}$setText(t){let e=this.$EditableText[0];e==t&&null!=e||(this._isShowPrompt=!1,this.textColor=this.$EditableText[1],this.displayAsPassword=this.$EditableText[2]),this._isFocusIn||""!=t&&null!=t||(t=e,this._isShowPrompt=!0,super.$setTextColor(this._promptColor),super.$setDisplayAsPassword(!1));let i=super.$setText(t);return this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"text"),i}$getText(){let t=super.$getText();return t==this.$EditableText[0]&&(t=""),t}$onAddToStage(t,e){super.$onAddToStage(t,e),this.on(dou2d.Event2D.FOCUS_IN,this.onfocusIn,this),this.on(dou2d.Event2D.FOCUS_OUT,this.onfocusOut,this),this.on(dou2d.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.on(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this)}$onRemoveFromStage(){super.$onRemoveFromStage(),this.off(dou2d.Event2D.FOCUS_IN,this.onfocusIn,this),this.off(dou2d.Event2D.FOCUS_OUT,this.onfocusOut,this),this.off(dou2d.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.off(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this)}onfocusOut(){this._isFocusIn=!1,this.text||this.showPromptText()}onTouchBegin(){this._isTouchCancle=!1}onTouchCancle(){this._isTouchCancle=!0}onfocusIn(){if(!dou2d.Capabilities.isMobile&&this._isTouchCancle)return void this._inputController.hideInput();this._isFocusIn=!0,this._isShowPrompt=!1,this.displayAsPassword=this.$EditableText[2];let t=this.$EditableText,e=this.text;e&&e!=t[0]||(this.textColor=t[1],this.text="")}showPromptText(){let t=this.$EditableText;this._isShowPrompt=!0,super.$setTextColor(this._promptColor),super.$setDisplayAsPassword(!1),this.text=t[0]}$setTextColor(t){return t=0|+t,this.$EditableText[1]=t,this._isShowPrompt||super.$setTextColor(t),!0}$setDisplayAsPassword(t){return this.$EditableText[2]=t,this._isShowPrompt||super.$setDisplayAsPassword(t),!0}initializeUIValues(){}createChildren(){this.onfocusOut()}childrenCreated(){}commitProperties(){}measure(){let t=this.$UIComponent,e=this.$propertyMap[3],i=NaN;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(i=t[13]):i=t[8]:(i=this._widthConstraint,this._widthConstraint=NaN),super.$setWidth(i),this.setMeasuredSize(this.textWidth,this.textHeight),super.$setWidth(e)}updateDisplayList(t,e){super.$setWidth(t),super.$setHeight(e)}invalidateParentLayout(){}setMeasuredSize(t,e){}invalidateProperties(){}validateProperties(){}invalidateSize(){}validateSize(t){}invalidateDisplayList(){}validateDisplayList(){}validateNow(){}setLayoutBoundsSize(e,i){if(t.sys.UIComponentImpl.prototype.setLayoutBoundsSize.call(this,e,i),isNaN(e)||e===this._widthConstraint||0==e)return;let s=this.$UIComponent;isNaN(s[9])&&e!=s[16]&&(this._widthConstraint=e,this.invalidateSize())}setLayoutBoundsPosition(t,e){}getLayoutBounds(t){}getPreferredBounds(t){}}t.EditableText=e,t.sys.implementUIComponent(e,dou2d.TextField)}(douUI||(douUI={})),function(t){class e extends dou2d.Bitmap{constructor(t){super(),this._sourceChanged=!1,this.__interface_type__="douUI.sys.IUIComponent",this.initializeUIValues(),t&&(this.source=t)}set source(t){this._source!=t&&(this._source=t,this._stage?this.parseSource():(this._sourceChanged=!0,this.invalidateProperties()))}get source(){return this._source}$setScale9Grid(t){let e=super.$setScale9Grid(t);return this.invalidateDisplayList(),e}$setFillMode(t){let e=super.$setFillMode(t);return this.invalidateDisplayList(),e}$setTexture(t){if(this._texture==t)return!1;let e=super.$setTexture(t);return this._sourceChanged=!1,this.invalidateSize(),this.invalidateDisplayList(),e}parseSource(){this._source&&"string"==typeof this._source?t.getAsset(this._source,(t,e)=>{this._source==e&&t&&t instanceof dou2d.Texture&&(this.$setTexture(t),this.dispatchEvent(dou.Event.COMPLETE))},this):this.$setTexture(this._source)}$measureContentBounds(t){let e=this._texture;if(e){let i=this.$UIComponent,s=i[10],n=i[11];if(isNaN(s)||isNaN(n))return void t.clear();"clip"==this._fillMode&&(s>e.$getTextureWidth()&&(s=e.$getTextureWidth()),n>e.$getTextureHeight()&&(n=e.$getTextureHeight())),t.set(0,0,s,n)}else t.clear()}initializeUIValues(){}createChildren(){this._sourceChanged&&this.parseSource()}setActualSize(e,i){t.sys.UIComponentImpl.prototype.setActualSize.call(this,e,i),super.$setWidth(e),super.$setHeight(i)}childrenCreated(){}commitProperties(){t.sys.UIComponentImpl.prototype.commitProperties.call(this),this._sourceChanged&&this.parseSource()}measure(){let t=this._texture;t?this.setMeasuredSize(t.$getTextureWidth(),t.$getTextureHeight()):this.setMeasuredSize(0,0)}updateDisplayList(t,e){this.$renderDirty=!0}invalidateParentLayout(){}setMeasuredSize(t,e){}invalidateProperties(){}validateProperties(){}invalidateSize(){}validateSize(t){}invalidateDisplayList(){}validateDisplayList(){}validateNow(){}setLayoutBoundsSize(t,e){}setLayoutBoundsPosition(t,e){}getLayoutBounds(t){}getPreferredBounds(t){}}t.Image=e,t.sys.implementUIComponent(e,dou2d.Bitmap)}(douUI||(douUI={})),function(t){class e extends t.Component{constructor(){super(),this.touchCaptured=!1,this.touchChildren=!1,this.on(dou2d.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)}onTouchBegin(t){this._stage.on(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this._stage.on(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()}onTouchCancle(t){let e=t.currentTarget;e.off(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.off(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()}onStageTouchEnd(t){let e=t.currentTarget;e.off(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.off(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.contains(t.target)&&this.buttonReleased(),this.touchCaptured=!1,this.invalidateState()}buttonReleased(){}getCurrentState(){return this.enabled?this.touchCaptured?"down":"up":"disabled"}}t.Button=e}(douUI||(douUI={})),function(t){class e extends t.Button{constructor(){super(...arguments),this._selected=!1,this._autoSelected=!0}set selected(t){(t=!!t)!==this._selected&&(this._selected=t,this.invalidateState(),this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selected"))}get selected(){return this._selected}set autoSelected(t){this._autoSelected=t}get autoSelected(){return this._autoSelected}buttonReleased(){this._autoSelected&&(this.selected=!this._selected,this.dispatchEvent(dou.Event.CHANGE))}getCurrentState(){let t=super.getCurrentState();return this._selected?t+"AndSelected":t}}t.ToggleButton=e}(douUI||(douUI={})),function(t){class e extends t.ToggleButton{}t.CheckBox=e}(douUI||(douUI={})),function(t){let e={};class i extends t.ToggleButton{constructor(t="radioGroup"){super(),this.$indexNumber=0,this._groupChanged=!1,this.groupName=t}set enabled(t){dou.superSetter(i,this,"enabled",t),this.invalidateDisplayList()}get enabled(){return!!this.$Component[0]&&(!this.$radioButtonGroup||this.$radioButtonGroup.$enabled)}set group(t){this._group!=t&&(this.$radioButtonGroup&&this.$radioButtonGroup.removeRadioButton(this,!1),this._group=t,this._groupName=t?this.group.$name:"radioGroup",this._groupChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())}get group(){if(!this._group&&this._groupName){let i=e[this._groupName];i||(i=new t.RadioButtonGroup,i.$name=this._groupName,e[this._groupName]=i),this._group=i}return this._group}set groupName(t){t&&""!=t&&(this._groupName=t,this.$radioButtonGroup&&this.$radioButtonGroup.removeRadioButton(this,!1),this._group=null,this._groupChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())}get groupName(){return this._groupName}set value(t){this._value!=t&&(this._value=t,this._selected&&this.group&&this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selectedValue"))}get value(){return this._value}commitProperties(){this._groupChanged&&(this.addToGroup(),this._groupChanged=!1),super.commitProperties()}addToGroup(){let t=this.group;return t&&t.addRadioButton(this),t}updateDisplayList(t,e){super.updateDisplayList(t,e),this.group&&(this._selected?this._group.$setSelection(this,!1):this.group.selection==this&&this._group.$setSelection(null,!1))}buttonReleased(){this.enabled&&!this.selected&&(this.$radioButtonGroup||this.addToGroup(),super.buttonReleased(),this.group.$setSelection(this,!0))}}t.RadioButton=i}(douUI||(douUI={})),function(t){let e=0;class i extends dou.EventDispatcher{constructor(t){super(),this.$enabled=!0,this.$name=t||"_radioButtonGroup"+e++,this._radioButtons=[]}set enabled(t){if(t=!!t,this.$enabled===t)return;this.$enabled=t;let e=this._radioButtons,i=e.length;for(let t=0;t<i;t++)e[t].invalidateState()}get enabled(){return this.$enabled}set selectedValue(t){if(this._selectedValue=t,null==t)return void this.$setSelection(null,!1);let e=this.numRadioButtons;for(let i=0;i<e;i++){if(this._radioButtons[i].value==t){this.changeSelection(i,!1),this._selectedValue=null,this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selectedValue");break}}}get selectedValue(){return this.selection?this.selection.value:null}set selection(t){this._selection!=t&&this.$setSelection(t,!1)}get selection(){return this._selection}$setSelection(t,e){if(this._selection==t)return!1;if(t){let i=this.numRadioButtons;for(let s=0;s<i;s++)if(t==this.getRadioButtonAt(s)){this.changeSelection(s,e);break}}else this._selection&&(this._selection.selected=!1,this._selection=null,e&&this.dispatchEvent(dou.Event.CHANGE));return this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selectedValue"),!0}get numRadioButtons(){return this._radioButtons.length}getRadioButtonAt(t){return this._radioButtons[t]}changeSelection(t,e){let i=this.getRadioButtonAt(t);i&&i!=this._selection&&(this._selection&&(this._selection.selected=!1),this._selection=i,this._selection.selected=!0,e&&this.dispatchEvent(dou.Event.CHANGE))}addRadioButton(t){t.on(dou2d.Event2D.REMOVED_FROM_STAGE,this.removedHandler,this);let e=this._radioButtons;e.push(t),e.sort(this.breadthOrderCompare);let i=e.length;for(let t=0;t<i;t++)e[t].$indexNumber=t;this._selectedValue&&(this.selectedValue=this._selectedValue),1==t.selected&&(this.selection=t),t.$radioButtonGroup=this,t.invalidateState()}removedHandler(t){let e=t.target;e==t.currentTarget&&(e.off(dou2d.Event2D.REMOVED_FROM_STAGE,this.removedHandler,this),this.removeRadioButton(e,!0))}breadthOrderCompare(t,e){let i=t.parent,s=e.parent;if(!i||!s)return 0;let n=t.$nestLevel,a=e.$nestLevel,o=0,h=0;return i==s&&(o=i.getChildIndex(t),h=s.getChildIndex(e)),n>a||o>h?1:n<a||h>o?-1:t==e?0:this.breadthOrderCompare(i,s)}removeRadioButton(t,e){if(t){let i=!1,s=this._radioButtons,n=s.length;for(let a=0;a<n;a++){let o=s[a];i?o.$indexNumber=o.$indexNumber-1:o==t&&(e&&t.on(dou2d.Event2D.ADDED_TO_STAGE,this.addedHandler,this),t==this._selection&&(this._selection=null),t.$radioButtonGroup=null,t.invalidateState(),this._radioButtons.splice(a,1),i=!0,a--,n--)}}}addedHandler(t){let e=t.target;e==t.currentTarget&&(e.off(dou2d.Event2D.ADDED_TO_STAGE,this.addedHandler,this),this.addRadioButton(e))}}t.RadioButtonGroup=i}(douUI||(douUI={})),function(t){class e extends dou2d.DisplayObjectContainer{constructor(){super(),this.__interface_type__="douUI.sys.IUIComponent",this.initializeUIValues(),this.$Group={0:0,1:0,2:0,3:0,4:!1,5:!1}}set touchThrough(t){this.$Group[5]=!!t}get touchThrough(){return this.$Group[5]}get numElements(){return this.$children.length}set layout(t){this._layout!=t&&(this._layout&&(this._layout.target=null),this._layout=t,t&&(t.target=this),this.invalidateSize(),this.invalidateDisplayList())}get layout(){return this._layout}set scrollEnabled(t){t=!!t;let e=this.$Group;t!==e[4]&&(e[4]=t,this.updateScrollRect())}get scrollEnabled(){return this.$Group[4]}set scrollH(t){t=+t||0;let e=this.$Group;t!==e[2]&&(e[2]=t,this.updateScrollRect()&&this._layout&&this._layout.scrollPositionChanged(),this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"scrollH"))}get scrollH(){return this.$Group[2]}set scrollV(t){t=+t||0;let e=this.$Group;t!=e[3]&&(e[3]=t,this.updateScrollRect()&&this._layout&&this._layout.scrollPositionChanged(),this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"scrollV"))}get scrollV(){return this.$Group[3]}get contentWidth(){return this.$Group[0]}get contentHeight(){return this.$Group[1]}updateScrollRect(){let t=this.$Group,e=t[4];if(e){let e=this.$UIComponent,i=dou.recyclable(dou2d.Rectangle);this.scrollRect=i.set(t[2],t[3],e[10],e[11]),i.recycle()}else this._scrollRect&&(this.scrollRect=null);return e}setContentSize(t,e){t=Math.ceil(+t||0),e=Math.ceil(+e||0);let i=this.$Group,s=i[0]!==t,n=i[1]!==e;(s||n)&&(i[0]=t,i[1]=e,s&&this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"contentWidth"),n&&this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"contentHeight"))}getElementAt(t){return this.$children[t]}getVirtualElementAt(t){return this.getElementAt(t)}setVirtualElementIndicesInView(t,e){}$hitTest(t,e){let i=super.$hitTest(t,e);if(i||this.$Group[5])return i;if(!this._visible||!this.touchEnabled||0===this.scaleX||0===this.scaleY||0===this.width||0===this.height)return null;let s=dou.recyclable(dou2d.Point);this.globalToLocal(t,e,s);let n=this.$UIComponent,a=dou.recyclable(dou2d.Rectangle),o=a.set(0,0,n[10],n[11]),h=this._scrollRect;return h&&(o.x=h.x,o.y=h.y),o.contains(s.x,s.y)?(s.recycle(),a.recycle(),this):(s.recycle(),a.recycle(),null)}initializeUIValues(){}createChildren(){this._layout||(this.layout=new t.BasicLayout)}childrenCreated(){}commitProperties(){}measure(){this._layout?this._layout.measure():this.setMeasuredSize(0,0)}updateDisplayList(t,e){this._layout&&this._layout.updateDisplayList(t,e),this.updateScrollRect()}invalidateParentLayout(){}setMeasuredSize(t,e){}invalidateProperties(){}validateProperties(){}invalidateSize(){}validateSize(t){}invalidateDisplayList(){}validateDisplayList(){}validateNow(){}setLayoutBoundsSize(t,e){}setLayoutBoundsPosition(t,e){}getLayoutBounds(t){}getPreferredBounds(t){}}t.Group=e,t.sys.implementUIComponent(e,dou2d.DisplayObjectContainer,!0)}(douUI||(douUI={})),function(t){class e extends t.Group{constructor(){super(),this._dataProviderChanged=!1,this.$DataGroup={0:!0,1:!1,2:new Map,3:new Map,4:!1,5:!1,6:null,7:!1,8:null,9:!1,10:!1,11:null},this._indexToRenderer=[]}set layout(t){if(t!=this._layout&&(this._layout&&(this._layout.setTypicalSize(0,0),this._layout.off("useVirtualLayoutChanged",this.onUseVirtualLayoutChanged,this)),this._layout&&t&&this._layout.useVirtualLayout!=t.useVirtualLayout&&this.onUseVirtualLayoutChanged(),dou.superSetter(e,this,"layout",t),t)){let e=this.$DataGroup[8];e&&t.setTypicalSize(e.width,e.height),t.useVirtualLayout=this.$DataGroup[0],t.on("useVirtualLayoutChanged",this.onUseVirtualLayoutChanged,this)}}get layout(){return dou.superGetter(e,this,"layout")}onUseVirtualLayoutChanged(t){let e=this.$DataGroup;e[1]=!0,e[9]=!0,this.removeDataProviderListener(),this.invalidateProperties()}set useVirtualLayout(t){t=!!t;let e=this.$DataGroup;t!==e[0]&&(e[0]=t,this._layout&&(this._layout.useVirtualLayout=t))}get useVirtualLayout(){return this._layout?this._layout.useVirtualLayout:this.$DataGroup[0]}set itemRenderer(t){let e=this.$DataGroup;e[6]!=t&&(e[6]=t,e[5]=!0,e[7]=!0,e[9]=!0,this.removeDataProviderListener(),this.invalidateProperties())}get itemRenderer(){return this.$DataGroup[6]}set dataProvider(t){this._dataProvider==t||t&&!t.getItemAt||(this.removeDataProviderListener(),this._dataProvider=t,this._dataProviderChanged=!0,this.$DataGroup[9]=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList())}get dataProvider(){return this._dataProvider}get numElements(){return this._dataProvider?this._dataProvider.length:0}getElementAt(t){return this._indexToRenderer[t]}getVirtualElementAt(t){if((t=0|+t)<0||t>=this._dataProvider.length)return null;let e=this._indexToRenderer[t];if(!e){let i=this._dataProvider.getItemAt(t);e=this.createVirtualRenderer(i),this._indexToRenderer[t]=e,this.updateRenderer(e,t,i);let s=this.$DataGroup;s[4]&&(e.validateNow(),s[4]=!1,this.rendererAdded(e,t,i))}return e}setVirtualElementIndicesInView(t,e){if(!this._layout||!this._layout.useVirtualLayout)return;let i=this._indexToRenderer,s=Object.keys(i),n=s.length;for(let i=0;i<n;i++){let n=+s[i];(n<t||n>e)&&this.freeRendererByIndex(n)}}freeRendererByIndex(t){let e=this._indexToRenderer[t];e&&(delete this._indexToRenderer[t],this.doFreeRenderer(e))}doFreeRenderer(t){let e=this.$DataGroup,i=e[2].get(t);e[3].has(i)||e[3].set(i,[]),e[3].get(i).push(t),t.visible=!1}invalidateSize(){this.$DataGroup[4]||super.invalidateSize()}createVirtualRenderer(t){let e,i=this.itemToRendererClass(t),s=this.$DataGroup,n=s[3];return n.has(i)&&n.get(i).length>0?(e=n.get(i).pop(),e.visible=!0,this.invalidateDisplayList(),e):(s[4]=!0,this.createOneRenderer(i))}createOneRenderer(t){let e=new t;return this.$DataGroup[2].set(e,t),this.addChild(e),e}removeDataProviderListener(){this._dataProvider&&this._dataProvider.off(t.CollectionEvent.COLLECTION_CHANGE,this.onCollectionChange,this)}onCollectionChange(t){switch(t.kind){case 0:this.itemAddedHandler(t.items,t.location);break;case 2:this.itemRemovedHandler(t.items,t.location);break;case 5:case 3:this.itemUpdatedHandler(t.items[0],t.location);break;case 4:case 1:if(this._layout&&this._layout.useVirtualLayout){let t=this._indexToRenderer,e=Object.keys(t);for(let t=e.length-1;t>=0;t--){let i=+e[t];this.freeRendererByIndex(i)}}this._dataProviderChanged=!0,this.invalidateProperties()}this.invalidateSize(),this.invalidateDisplayList()}itemAddedHandler(t,e){let i=t.length;for(let s=0;s<i;s++)this.itemAdded(t[s],e+s);this.resetRenderersIndices()}itemRemovedHandler(t,e){for(let i=t.length-1;i>=0;i--)this.itemRemoved(t[i],e+i);this.resetRenderersIndices()}itemAdded(t,e){if(this._layout&&this._layout.elementAdded(e),this._layout&&this._layout.useVirtualLayout)return void this._indexToRenderer.splice(e,0,null);let i=this.createVirtualRenderer(t);if(this._indexToRenderer.splice(e,0,i),i){this.updateRenderer(i,e,t);let s=this.$DataGroup;s[4]&&(s[4]=!1,this.rendererAdded(i,e,t))}}itemRemoved(t,e){this._layout&&this._layout.elementRemoved(e);let i=this._indexToRenderer[e];this._indexToRenderer.length>e&&this._indexToRenderer.splice(e,1),i&&(this._layout&&this._layout.useVirtualLayout?this.doFreeRenderer(i):(this.rendererRemoved(i,e,t),this.removeChild(i)))}resetRenderersIndices(){let t=this._indexToRenderer;if(0!=t.length)if(this._layout&&this._layout.useVirtualLayout){let e=Object.keys(t),i=e.length;for(let t=0;t<i;t++){let i=+e[t];this.resetRendererItemIndex(i)}}else{let e=t.length;for(let t=0;t<e;t++)this.resetRendererItemIndex(t)}}itemUpdatedHandler(t,e){if(this.$DataGroup[10])return;let i=this._indexToRenderer[e];i&&this.updateRenderer(i,e,t)}resetRendererItemIndex(t){let e=this._indexToRenderer[t];e&&(e.itemIndex=t)}itemToRendererClass(e){let i,s=this.$DataGroup;return i||(i=s[6]),i||(i=t.ItemRenderer),i}createChildren(){if(!this._layout){let e=new t.VerticalLayout;e.gap=0,e.horizontalAlign=11,this.layout=e}super.createChildren()}commitProperties(){let e=this.$DataGroup;(e[5]||this._dataProviderChanged||e[1])&&(this.removeAllRenderers(),this._layout&&this._layout.clearVirtualLayoutCache(),this.setTypicalLayoutRect(null),e[1]=!1,e[5]=!1,this._dataProvider&&this._dataProvider.on(t.CollectionEvent.COLLECTION_CHANGE,this.onCollectionChange,this),this._layout&&this._layout.useVirtualLayout?(this.invalidateSize(),this.invalidateDisplayList()):this.createRenderers(),this._dataProviderChanged&&(this._dataProviderChanged=!1,this.scrollV=this.scrollH=0)),super.commitProperties(),e[7]&&(e[7]=!1,this._dataProvider&&this._dataProvider.length>0&&(e[11]=this._dataProvider.getItemAt(0),this.measureRendererSize()))}measure(){this._layout&&this._layout.useVirtualLayout&&this.ensureTypicalLayoutElement(),super.measure()}updateDisplayList(t,e){let i=this._layout&&this._layout.useVirtualLayout;i&&this.ensureTypicalLayoutElement(),super.updateDisplayList(t,e);let s=this.$DataGroup;if(i){let t=s[8];if(t){let e=this._indexToRenderer[0];if(e){let i=dou.recyclable(dou2d.Rectangle);e.getPreferredBounds(i),i.width==t.width&&i.height==t.height||(s[8]=null),i.recycle()}}}}ensureTypicalLayoutElement(){this.$DataGroup[8]||this._dataProvider&&this._dataProvider.length>0&&(this.$DataGroup[11]=this._dataProvider.getItemAt(0),this.measureRendererSize())}measureRendererSize(){let t=this.$DataGroup;if(null==t[11])return void this.setTypicalLayoutRect(null);let e=this.createVirtualRenderer(t[11]);if(!e)return void this.setTypicalLayoutRect(null);this.updateRenderer(e,0,t[11]),e.validateNow();let i=dou.recyclable(dou2d.Rectangle);e.getPreferredBounds(i);let s=new dou2d.Rectangle(0,0,i.width,i.height);i.recycle(),this._layout&&this._layout.useVirtualLayout?(t[4]&&this.rendererAdded(e,0,t[11]),this.doFreeRenderer(e)):this.removeChild(e),this.setTypicalLayoutRect(s),t[4]=!1}setTypicalLayoutRect(t){this.$DataGroup[8]=t,this._layout&&(t?this._layout.setTypicalSize(t.width,t.height):this._layout.setTypicalSize(0,0))}removeAllRenderers(){let t=this._indexToRenderer,e=Object.keys(t),i=e.length;for(let s=0;s<i;s++){let i=t[e[s]];i&&(this.rendererRemoved(i,i.itemIndex,i.data),this.removeChild(i))}this._indexToRenderer=[];let s=this.$DataGroup;if(s[9]){let t=s[3],e=t.keys(),i=e.length;for(let s=0;s<i;s++){let i=e[s],n=t.get(i),a=n.length;for(let t=0;t<a;t++){let e=n[t];this.rendererRemoved(e,e.itemIndex,e.data),this.removeChild(e)}}s[3].clear(),s[2].clear(),s[9]=!1}}createRenderers(){if(!this._dataProvider)return;let t=0,e=this._dataProvider.length;for(let i=0;i<e;i++){let e=this._dataProvider.getItemAt(i),s=this.itemToRendererClass(e),n=this.createOneRenderer(s);n&&(this._indexToRenderer[t]=n,this.updateRenderer(n,t,e),this.rendererAdded(n,t,e),t++)}}updateRenderer(t,e,i){let s=this.$DataGroup;return s[10]=!0,t.itemIndex=e,t.parent==this&&this.setChildIndex(t,e),t.data=i,s[10]=!1,t}rendererAdded(t,e,i){}rendererRemoved(t,e,i){}}t.DataGroup=e}(douUI||(douUI={})),function(t){class e extends t.DataGroup{constructor(){super(),this.$ListBase={0:!1,1:!1,2:-2,3:-1,4:!1,5:void 0,6:!1,7:null,8:!1}}set requireSelection(t){t=!!t;let e=this.$ListBase;t!==e[0]&&(e[0]=t,t&&(e[1]=!0,this.invalidateProperties()))}get requireSelection(){return this.$ListBase[0]}set selectedIndex(t){t=0|+t,this.setSelectedIndex(t,!1)}get selectedIndex(){return this.getSelectedIndex()}setSelectedIndex(t,e){if(t==this.selectedIndex)return;let i=this.$ListBase;e&&(i[4]=i[4]||e),i[2]=t,this.invalidateProperties()}getSelectedIndex(){let t=this.$ListBase;return t[2]!=e.NO_PROPOSED_SELECTION?t[2]:t[3]}set selectedItem(t){this.setSelectedItem(t,!1)}get selectedItem(){return this.getSelectedItem()}setSelectedItem(t,e=!1){if(this.selectedItem===t)return;let i=this.$ListBase;e&&(i[4]=i[4]||e),i[5]=t,this.invalidateProperties()}getSelectedItem(){let t=this.$ListBase;if(void 0!==t[5])return t[5];let i=this.getSelectedIndex();return i!=e.NO_SELECTION&&null!=this._dataProvider&&this._dataProvider.length>i?this._dataProvider.getItemAt(i):void 0}commitProperties(){let t=this._dataProviderChanged;super.commitProperties();let i=this.$ListBase,s=this.getSelectedIndex(),n=this._dataProvider;t&&(s>=0&&n&&s<n.length?this.itemSelected(s,!0):this.requireSelection?i[2]=0:this.setSelectedIndex(-1,!1)),i[1]&&(i[1]=!1,i[0]&&s==e.NO_SELECTION&&n&&n.length>0&&(i[2]=0)),void 0!==i[5]&&(i[2]=n?n.getItemIndex(i[5]):e.NO_SELECTION,i[5]=void 0);let a=!1;i[2]!=e.NO_PROPOSED_SELECTION&&(a=this.commitSelection()),i[6]&&(i[6]=!1,a||this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selectedIndex"))}updateRenderer(t,e,i){return this.itemSelected(e,this.isItemIndexSelected(e)),super.updateRenderer(t,e,i)}itemSelected(t,e){let i=this._indexToRenderer[t];i&&(i.selected=e)}isItemIndexSelected(t){return t==this.selectedIndex}commitSelection(t=!0){let i=this._dataProvider,s=this.$ListBase,n=i?i.length-1:-1,a=s[3],o=s[2];if(o<e.NO_SELECTION&&(o=e.NO_SELECTION),o>n&&(o=n),s[0]&&o==e.NO_SELECTION&&i&&i.length>0)return s[2]=e.NO_PROPOSED_SELECTION,s[4]=!1,!1;if(s[4]){if(!this.dispatchEvent(dou.Event.CHANGING,null,!0))return this.itemSelected(s[2],!1),s[2]=e.NO_PROPOSED_SELECTION,s[4]=!1,!1}return s[3]=o,s[2]=e.NO_PROPOSED_SELECTION,a!=e.NO_SELECTION&&this.itemSelected(a,!1),s[3]!=e.NO_SELECTION&&this.itemSelected(s[3],!0),t&&(s[4]&&(this.dispatchEvent(dou.Event.CHANGE),s[4]=!1),this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selectedIndex"),this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selectedItem")),!0}adjustSelection(t){let i=this.$ListBase;i[2]!=e.NO_PROPOSED_SELECTION?i[2]=t:i[3]=t,i[6]=!0,this.invalidateProperties()}itemAdded(t,i){super.itemAdded(t,i);let s=this.getSelectedIndex();s==e.NO_SELECTION?this.$ListBase[0]&&this.adjustSelection(i):i<=s&&this.adjustSelection(s+1)}itemRemoved(t,i){if(super.itemRemoved(t,i),this.selectedIndex==e.NO_SELECTION)return;let s=this.getSelectedIndex();i==s?this.requireSelection&&this._dataProvider&&this._dataProvider.length>0?0==i?(this.$ListBase[2]=0,this.invalidateProperties()):this.setSelectedIndex(0,!1):this.adjustSelection(-1):i<s&&this.adjustSelection(s-1)}onCollectionChange(t){super.onCollectionChange(t),4==t.kind?0==this._dataProvider.length&&this.setSelectedIndex(e.NO_SELECTION,!1):1==t.kind&&this.dataProviderRefreshed()}dataProviderRefreshed(){this.setSelectedIndex(e.NO_SELECTION,!1)}rendererAdded(t,e,i){t.on(dou2d.TouchEvent.TOUCH_BEGIN,this.onRendererTouchBegin,this),t.on(dou2d.TouchEvent.TOUCH_END,this.onRendererTouchEnd,this),t.on(dou2d.TouchEvent.TOUCH_CANCEL,this.onRendererTouchCancle,this)}rendererRemoved(t,e,i){t.off(dou2d.TouchEvent.TOUCH_BEGIN,this.onRendererTouchBegin,this),t.off(dou2d.TouchEvent.TOUCH_END,this.onRendererTouchEnd,this),t.off(dou2d.TouchEvent.TOUCH_CANCEL,this.onRendererTouchCancle,this)}onRendererTouchBegin(t){if(!this._stage)return;let e=this.$ListBase;t.$isDefaultPrevented||(e[8]=!1,e[7]=t.currentTarget,this._stage.on(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this))}onRendererTouchCancle(t){let e=this.$ListBase;e[7]=null,e[8]=!0,this._stage&&this._stage.off(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this)}onRendererTouchEnd(t){let e=this.$ListBase,i=t.currentTarget;i==e[7]&&(e[8]||(this.setSelectedIndex(i.itemIndex,!0),this.dispatchEvent2D(dou2d.Event2D.ITEM_TAP,i,!0)),e[8]=!1)}onStageTouchEnd(t){t.currentTarget.off(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.$ListBase[7]=null}}e.NO_SELECTION=-1,e.NO_PROPOSED_SELECTION=-2,t.ListBase=e}(douUI||(douUI={})),function(t){class e extends t.ScrollBarBase{updateDisplayList(t,e){super.updateDisplayList(t,e);let i=this.thumb,s=this._viewport;if(!i||!s)return;let n=dou.recyclable(dou2d.Rectangle);i.getPreferredBounds(n);let a=n.width,o=n.y;n.recycle();let h=s.scrollH,l=s.contentWidth,r=s.width;if(h<=0){let t=a*(1- -h/(.5*r));t=Math.max(5,Math.round(t)),i.setLayoutBoundsSize(t,NaN),i.setLayoutBoundsPosition(0,o)}else if(h>=l-r){let e=a*(1-(h-l+r)/(.5*r));e=Math.max(5,Math.round(e)),i.setLayoutBoundsSize(e,NaN),i.setLayoutBoundsPosition(t-e,o)}else{let e=(t-a)*h/(l-r);i.setLayoutBoundsSize(NaN,NaN),i.setLayoutBoundsPosition(e,o)}}onPropertyChanged(t){switch(t.data){case"scrollH":case"contentWidth":this.invalidateDisplayList()}}}t.HScrollBar=e}(douUI||(douUI={})),function(t){class e extends t.SliderBase{pointToValue(t,e){if(!this.thumb||!this.track)return 0;let i=this.$Range,s=i[0]-i[2],n=this.getThumbRange();return i[2]+(0!=n?t/n*s:0)}getThumbRange(){let t=dou.recyclable(dou2d.Rectangle);this.track.getLayoutBounds(t);let e=t.width;return this.thumb.getLayoutBounds(t),e-=t.width,t.recycle(),e}updateSkinDisplayList(){if(!this.thumb||!this.track)return;let t=this.$Range,e=this.getThumbRange(),i=t[0]-t[2],s=i>0?(this.pendingValue-t[2])/i*e:0,n=dou.recyclable(dou2d.Point),a=this.track.localToGlobal(s,0,n),o=a.x,h=a.y,l=this.thumb.parent.globalToLocal(o,h,n).x,r=dou.recyclable(dou2d.Rectangle);if(this.thumb.getLayoutBounds(r),this.thumb.setLayoutBoundsPosition(Math.round(l),r.y),r.recycle(),this.trackHighlight&&this.trackHighlight.parent){let t=this.trackHighlight.parent.globalToLocal(o,h,n).x-s;this.trackHighlight.x=Math.round(t),this.trackHighlight.width=Math.round(s)}n.recycle()}}t.HSlider=e}(douUI||(douUI={})),function(t){class e extends t.Component{constructor(){super(),this._itemIndex=-1,this._selected=!1,this._touchCaptured=!1,this.on(dou2d.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)}set data(t){this._data=t,this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"data"),this.dataChanged()}get data(){return this._data}set itemIndex(t){this._itemIndex=t}get itemIndex(){return this._itemIndex}set selected(t){this._selected!=t&&(this._selected=t,this.invalidateState())}get selected(){return this._selected}dataChanged(){}onTouchBegin(t){this.stage&&(this.stage.on(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.stage.on(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this._touchCaptured=!0,this.invalidateState(),t.updateAfterEvent())}onTouchCancle(t){this._touchCaptured=!1;let e=t.currentTarget;e.off(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.off(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.invalidateState()}onStageTouchEnd(t){let e=t.currentTarget;e.off(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.off(dou2d.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this._touchCaptured=!1,this.invalidateState()}getCurrentState(){let t="up";return this.enabled||(t="disabled"),this._touchCaptured&&(t="down"),this._selected?t+"AndSelected":t}}t.ItemRenderer=e}(douUI||(douUI={})),function(t){class e extends t.Group{constructor(){super(),this._text="",this._textInvalid=!1,this._styleInvalid=!1,this._lastWidth=0,this._lastHeight=0,this._label=new t.Label,this._label.multiline=!0,this._label.wordWrap=!0,this._label.percentWidth=100,this._imageList=[]}get label(){return this._label}set fontFamily(t){this._label.fontFamily!=t&&(this._label.fontFamily=t,this._styleInvalid=!0,dou2d.callLaterUnique(this.onRender,this))}get fontFamily(){return this._label.fontFamily}set size(t){this._label.size!=t&&(this._label.size=t,this._styleInvalid=!0,dou2d.callLaterUnique(this.onRender,this))}get size(){return this._label.size}set bold(t){this._label.bold!=t&&(this._label.bold=t,this._styleInvalid=!0,dou2d.callLaterUnique(this.onRender,this))}get bold(){return this._label.bold}set italic(t){this._label.italic!=t&&(this._label.italic=t,this._styleInvalid=!0,dou2d.callLaterUnique(this.onRender,this))}get italic(){return this._label.italic}set textAlign(t){this._label.textAlign!=t&&(this._label.textAlign=t,this._styleInvalid=!0,dou2d.callLaterUnique(this.onRender,this))}get textAlign(){return this._label.textAlign}set verticalAlign(t){this._label.verticalAlign!=t&&(this._label.verticalAlign=t,this._styleInvalid=!0,dou2d.callLaterUnique(this.onRender,this))}get verticalAlign(){return this._label.verticalAlign}set lineSpacing(t){this._label.lineSpacing!=t&&(this._label.lineSpacing=t,this._styleInvalid=!0,dou2d.callLaterUnique(this.onRender,this))}get lineSpacing(){return this._label.lineSpacing}set textColor(t){this._label.textColor=t}get textColor(){return this._label.textColor}set text(t){this._text!=t&&(this._text=t,this._textInvalid=!0,this._styleInvalid=!0,dou2d.callLaterUnique(this.onRender,this))}get text(){return this._text}set strokeColor(t){this._label.strokeColor=t}get strokeColor(){return this._label.strokeColor}set stroke(t){this._label.stroke=t}get stroke(){return this._label.stroke}get numLines(){return this._label.numLines}get textWidth(){return this._label.textWidth}get textHeight(){return this._label.textHeight}set pickup(t){this._pickup=t}get pickup(){return this._pickup}set sourceFunc(t){this._sourceFunc=t}get sourceFunc(){return this._sourceFunc}set scaleFunc(t){this._scaleFunc=t}get scaleFunc(){return this._scaleFunc}set linkPreventTap(t){this._label.linkPreventTap=t}get linkPreventTap(){return this._label.linkPreventTap}createChildren(){super.createChildren(),this.on(dou2d.Event2D.RESIZE,this.onResize,this),this.addChild(this._label)}onResize(t){dou2d.callLaterUnique(this.$onResize,this)}$onResize(){let t=this.width,e=this.height;this._lastWidth==t&&this._lastHeight==e||(this._lastWidth=t,this._lastHeight=e,this._styleInvalid=!0,this.onRender())}onRender(){if(this._textInvalid){this._textInvalid=!1;for(let t of this._imageList)t.icon.off(dou.Event.COMPLETE,this.onImageLoad,this),t.icon.recycle();this._imageList.length=0;let e,i=new RegExp(this._pickup);for(;e=i.exec(this._text);){let i=this._sourceFunc(e),s=dou.recyclable(t.Image),n=1;this._scaleFunc&&(n=this._scaleFunc(e));let a=e[0];s.on(dou.Event.COMPLETE,this.onImageLoad,this),s.source=i,s.scaleX=s.scaleY=n,s.smoothing=!0,this._imageList.push({sign:a,icon:s,x:0,y:0,scale:n})}}if(this._styleInvalid){this._styleInvalid=!1;let t=this._text;for(let e of this._imageList){let i=Math.max(e.icon.width,e.icon.height,5);t=t.replace(e.sign,`<font size = "${~~(i*e.scale)}">　</font>`)}this._label.textFlow=dou2d.HtmlTextParser.parse(t);let e=this._label.textWidth;0==e&&(this._label.$propertyMap[18]=!0,this._label.$propertyMap[3]=this._label.$propertyMap[4]=NaN,e=this._label.textWidth),e=Math.max(this._label.width,e),this._label.$propertyMap[3]=e>this.maxWidth?this.maxWidth:e,this._label.height=this._label.textHeight,dou2d.callLaterUnique(this.onTextRender,this)}}onImageLoad(t){let e=t.target;e.width=e.texture.textureWidth,e.height=e.texture.textureHeight,this._styleInvalid=!0,dou2d.callLaterUnique(this.onRender,this)}onTextRender(){let t=this._label.$getLinesArr(),e=0,i=0,s=0;for(let n=0;n<t.length;n++){let a=t[n];0==this._label.textAlign?i=0:2==this._label.textAlign?i=this._label.width-a.width:1==this._label.textAlign&&(i=this._label.width-a.width>>1);for(let t of a.elements){if("　"==t.text){let t=this._imageList[e++];t&&(t.x=i,t.y=s)}i+=t.width}s+=a.height}for(let t of this._imageList){let e=t.icon;e.x=this._label.x+t.x,e.y=this._label.y+t.y,this.addChild(e)}this.dispatchEvent2D(dou2d.Event2D.RICH_TEXT_CHANGE,null,!0)}clear(){for(let t of this._imageList)t.icon.off(dou.Event.COMPLETE,this.onImageLoad,this),t.icon.recycle();this._imageList.length=0}}t.RichLabel=e}(douUI||(douUI={})),function(t){class e extends t.ListBase{constructor(){super(),this._allowMultipleSelection=!1,this._selectedIndices=[]}set selectedIndex(t){this.setSelectedIndex(t)}get selectedIndex(){return this._proposedSelectedIndices?this._proposedSelectedIndices.length>0?this._proposedSelectedIndices[0]:-1:this.getSelectedIndex()}set allowMultipleSelection(t){this._allowMultipleSelection=t}get allowMultipleSelection(){return this._allowMultipleSelection}set selectedItems(t){let e=[];if(t){let i=t.length;for(let s=0;s<i;s++){let i=this._dataProvider.getItemIndex(t[s]);if(-1!=i&&e.splice(0,0,i),-1==i){e=[];break}}}this.setSelectedIndices(e,!1)}get selectedItems(){let t=[],e=this.selectedIndices;if(e){let i=e.length;for(let s=0;s<i;s++)t[s]=this._dataProvider.getItemAt(e[s])}return t}set selectedIndices(t){this.setSelectedIndices(t,!1)}get selectedIndices(){return this._proposedSelectedIndices?this._proposedSelectedIndices:this._selectedIndices}setSelectedIndices(t,e){let i=this.$ListBase;e&&(i[4]=i[4]||e),this._proposedSelectedIndices=t||[],this.invalidateProperties()}commitProperties(){super.commitProperties(),this._proposedSelectedIndices&&this.commitSelection()}commitSelection(e=!0){let i=this.$ListBase,s=i[3];if(this._proposedSelectedIndices){if(this._proposedSelectedIndices=this._proposedSelectedIndices.filter(this.isValidIndex,this),!this._allowMultipleSelection&&this._proposedSelectedIndices.length>0){let t=[];t.push(this._proposedSelectedIndices[0]),this._proposedSelectedIndices=t}this._proposedSelectedIndices.length>0?i[2]=this._proposedSelectedIndices[0]:i[2]=-1}let n=super.commitSelection(!1);if(!n)return this._proposedSelectedIndices=null,!1;let a=this.getSelectedIndex();return a>t.ListBase.NO_SELECTION&&(this._proposedSelectedIndices?-1==this._proposedSelectedIndices.indexOf(a)&&this._proposedSelectedIndices.push(a):this._proposedSelectedIndices=[a]),this._proposedSelectedIndices&&(-1!=this._proposedSelectedIndices.indexOf(s)&&this.itemSelected(s,!0),this.commitMultipleSelection()),e&&n&&(i[4]&&(this.dispatchEvent(dou.Event.CHANGE),i[4]=!1),this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selectedIndex"),this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selectedItem")),n}isValidIndex(t,e,i){return this._dataProvider&&t>=0&&t<this._dataProvider.length&&t%1==0}commitMultipleSelection(){let t,e,i=[],s=[],n=this._selectedIndices,a=this._proposedSelectedIndices;if(n.length>0&&a.length>0){for(e=a.length,t=0;t<e;t++)-1==n.indexOf(a[t])&&s.push(a[t]);for(e=n.length,t=0;t<e;t++)-1==a.indexOf(n[t])&&i.push(n[t])}else n.length>0?i=n:a.length>0&&(s=a);if(this._selectedIndices=a,i.length>0)for(e=i.length,t=0;t<e;t++)this.itemSelected(i[t],!1);if(s.length>0)for(e=s.length,t=0;t<e;t++)this.itemSelected(s[t],!0);this._proposedSelectedIndices=null}isItemIndexSelected(t){return this._allowMultipleSelection?-1!=this._selectedIndices.indexOf(t):super.isItemIndexSelected(t)}dataProviderRefreshed(){this._allowMultipleSelection||super.dataProviderRefreshed()}calculateSelectedIndices(t){let e=[],i=this._selectedIndices,s=i.length;if(s>0){if(1==s&&i[0]==t)return this.$ListBase[0]?(e.splice(0,0,i[0]),e):e;{let n=!1;for(let a=0;a<s;a++)i[a]==t?n=!0:i[a]!=t&&e.splice(0,0,i[a]);return n||e.splice(0,0,t),e}}return e.splice(0,0,t),e}onRendererTouchEnd(t){if(this._allowMultipleSelection){let e=t.currentTarget;if(e!=this.$ListBase[7])return;this.setSelectedIndices(this.calculateSelectedIndices(e.itemIndex),!0),this.dispatchEvent2D(dou2d.Event2D.ITEM_TAP,e,!0)}else super.onRendererTouchEnd(t)}}t.List=e}(douUI||(douUI={})),function(t){class e extends t.Range{constructor(){super(...arguments),this._direction=0,this._thumbInitX=0,this._thumbInitY=0}set labelFunction(t){this._labelFunction!=t&&(this._labelFunction=t,this.invalidateDisplayList())}get labelFunction(){return this._labelFunction}set direction(t){this._direction!=t&&(this.thumb&&(this.thumb.x=this._thumbInitX),this.thumb&&(this.thumb.y=this._thumbInitY),this._direction=t,this.invalidateDisplayList())}get direction(){return this._direction}updateSkinDisplayList(){let t=this.value,e=this.maximum,i=this.thumb;if(i){let s=i.width,n=i.height,a=Math.round(t/e*s);(a<0||a===1/0)&&(a=0);let o=Math.round(t/e*n);(o<0||o===1/0)&&(o=0);let h=i.scrollRect;h||(h=new dou2d.Rectangle),h.set(0,0,s,n);let l=i.x-h.x,r=i.y-h.y;switch(this._direction){case 0:h.width=a,i.x=l;break;case 1:h.width=a,h.x=s-a,i.x=h.x;break;case 2:h.height=o,i.y=r;break;case 3:h.height=o,h.y=n-o,i.y=h.y}i.scrollRect=h}this.labelDisplay&&(this.labelDisplay.text=this.valueToLabel(t,e))}valueToLabel(t,e){return null!=this.labelFunction?this._labelFunction(t,e):t+"/"+e}}t.ProgressBar=e}(douUI||(douUI={})),function(t){class e extends t.Component{constructor(t,e,i){super(),this._fillColor=0,this._fillAlpha=1,this._strokeColor=4473924,this._strokeAlpha=1,this._strokeWeight=0,this._ellipseWidth=0,this._ellipseHeight=0,this.touchChildren=!1,this._graphics=new dou2d.Graphics,this._graphics.$setTarget(this),this.width=t,this.height=e,this.fillColor=i}get graphics(){return this._graphics}set fillColor(t){null!=t&&this._fillColor!=t&&(this._fillColor=t,this.invalidateDisplayList())}get fillColor(){return this._fillColor}set fillAlpha(t){this._fillAlpha!=t&&(this._fillAlpha=t,this.invalidateDisplayList())}get fillAlpha(){return this._fillAlpha}set strokeColor(t){this._strokeColor!=t&&(this._strokeColor=t,this.invalidateDisplayList())}get strokeColor(){return this._strokeColor}set strokeAlpha(t){this._strokeAlpha!=t&&(this._strokeAlpha=t,this.invalidateDisplayList())}get strokeAlpha(){return this._strokeAlpha}set strokeWeight(t){this._strokeWeight!=t&&(this._strokeWeight=t,this.invalidateDisplayList())}get strokeWeight(){return this._strokeWeight}set ellipseWidth(t){this._ellipseWidth!=t&&(this._ellipseWidth=t,this.invalidateDisplayList())}get ellipseWidth(){return this._ellipseWidth}set ellipseHeight(t){this._ellipseHeight!=t&&(this._ellipseHeight=t,this.invalidateDisplayList())}get ellipseHeight(){return this._ellipseHeight}$measureContentBounds(t){this._graphics&&t.set(0,0,this.width,this.height)}updateDisplayList(t,e){let i=this.graphics;i.clear(),this._strokeWeight>0&&(i.beginFill(this._fillColor,0),i.lineStyle(this._strokeWeight,this._strokeColor,this._strokeAlpha,"square","miter"),0==this._ellipseWidth&&0==this._ellipseHeight?i.drawRect(this._strokeWeight/2,this._strokeWeight/2,t-this._strokeWeight,e-this._strokeWeight):i.drawRoundRect(this._strokeWeight/2,this._strokeWeight/2,t-this._strokeWeight,e-this._strokeWeight,this._ellipseWidth,this._ellipseHeight),i.endFill()),i.beginFill(this._fillColor,this._fillAlpha),i.lineStyle(this._strokeWeight,this._strokeColor,0,"square","miter"),0==this._ellipseWidth&&0==this._ellipseHeight?i.drawRect(this._strokeWeight,this._strokeWeight,t-2*this._strokeWeight,e-2*this._strokeWeight):i.drawRoundRect(this._strokeWeight,this._strokeWeight,t-2*this._strokeWeight,e-2*this._strokeWeight,this._ellipseWidth,this._ellipseHeight),i.endFill()}$onRemoveFromStage(){super.$onRemoveFromStage(),this._graphics&&this._graphics.$onRemoveFromStage()}}t.Rect=e}(douUI||(douUI={})),function(t){class e extends t.Component{constructor(){super(),this._bounces=!0;let e=new t.sys.TouchScroll(this,this.horizontalUpdateHandler,this.horizontalEndHandler),i=new t.sys.TouchScroll(this,this.verticalUpdateHandler,this.verticalEndHanlder);this.$Scroller={0:0,1:0,2:null,3:0,4:0,5:!1,6:!1,7:!1,8:e,9:i,10:null,11:!1}}set bounces(t){this._bounces=!!t;let e=this.$Scroller[8];e&&(e.bounces=this._bounces);let i=this.$Scroller[9];i&&(i.bounces=this._bounces)}get bounces(){return this._bounces}set throwSpeed(t){(t=+t)<0&&(t=0),this.$Scroller[8].scrollFactor=t,this.$Scroller[9].scrollFactor=t}get throwSpeed(){return this.$Scroller[8].scrollFactor}set scrollPolicyV(t){let e=this.$Scroller;e[0]!=t&&(e[0]=t,this.checkScrollPolicy())}get scrollPolicyV(){return this.$Scroller[0]}set scrollPolicyH(t){let e=this.$Scroller;e[1]!=t&&(e[1]=t,this.checkScrollPolicy())}get scrollPolicyH(){return this.$Scroller[1]}set viewport(t){let e=this.$Scroller;t!=e[10]&&(this.uninstallViewport(),e[10]=t,e[11]=!1,this.installViewport())}get viewport(){return this.$Scroller[10]}uninstallViewport(){this.horizontalScrollBar&&(this.horizontalScrollBar.viewport=null),this.verticalScrollBar&&(this.verticalScrollBar.viewport=null);let t=this.viewport;t&&(t.scrollEnabled=!1,t.off(dou2d.TouchEvent.TOUCH_BEGIN,this.onViewportTouchBegin,this),t.off(dou2d.Event2D.REMOVED,this.onViewPortRemove,this),0==this.$Scroller[11]&&this.removeChild(t))}installViewport(){let t=this.viewport;t&&(this.addChildAt(t,0),t.scrollEnabled=!0,t.on(dou2d.TouchEvent.TOUCH_BEGIN,this.onViewportTouchBegin,this),t.on(dou2d.Event2D.REMOVED,this.onViewPortRemove,this)),this.horizontalScrollBar&&(this.horizontalScrollBar.viewport=t),this.verticalScrollBar&&(this.verticalScrollBar.viewport=t)}onViewportTouchBegin(t){if(!this._stage)return;this.checkScrollPolicy()&&this.onTouchBegin(t)}onViewPortRemove(t){t.target==this.viewport&&(this.$Scroller[11]=!0,this.viewport=null)}checkScrollPolicy(){let t,e=this.$Scroller,i=e[10];if(!i)return!1;let s,n=i.$UIComponent;switch(e[1]){case 0:t=i.contentWidth>n[10]||0!==i.scrollH;break;case 2:t=!0;break;case 1:t=!1}switch(e[6]=t,e[0]){case 0:s=i.contentHeight>n[11]||0!==i.scrollV;break;case 2:s=!0;break;case 1:s=!1}return e[7]=s,t||s}onTouchBegin(t){if(t.$isDefaultPrevented())return;if(!this.checkScrollPolicy())return;this._downTarget=t.target;let e=this.$Scroller;this.stopAnimation(),e[3]=t.stageX,e[4]=t.stageY,e[6]&&e[8].start(t.stageX),e[7]&&e[9].start(t.stageY);let i=this._stage;this.on(dou2d.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),i.on(dou2d.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.on(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.on(dou2d.Event2D.REMOVED_FROM_STAGE,this.onRemoveListeners,this)}onTouchMove(i){if(i.$isDefaultPrevented())return;let s=this.$Scroller;if(!s[5]){let n,a;if(n=!(Math.abs(s[3]-i.stageX)<e.scrollThreshold),a=!(Math.abs(s[4]-i.stageY)<e.scrollThreshold),!n&&!a)return;if(!a&&n&&1==s[1])return;if(!n&&a&&1==s[0])return;s[5]=!0,this.touchChildren=!1,this._downTarget.dispatchTouchEvent(dou2d.TouchEvent.TOUCH_CANCEL,i.stageX,i.stageY,i.touchPointID,i.touchDown,!0,!0);let o=this.horizontalScrollBar,h=this.verticalScrollBar;o&&o.autoVisibility&&s[6]&&(o.visible=!0),h&&h.autoVisibility&&s[7]&&(h.visible=!0),s[2]&&s[2].reset(),this.dispatchUIEvent(t.UIEvent.CHANGE_START),this._stage.on(dou2d.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)}i.preventDefault();let n=s[10],a=n.$UIComponent;s[6]&&s[8].update(i.stageX,n.contentWidth-a[10],n.scrollH),s[7]&&s[9].update(i.stageY,n.contentHeight-a[11],n.scrollV)}onTouchCancel(t){this.$Scroller[5]||this.onRemoveListeners()}onTouchEnd(t){let e=this.$Scroller;e[5]=!1,this.touchChildren=!0,this.onRemoveListeners();let i=e[10],s=i.$UIComponent;e[8].isStarted&&e[8].finish(i.scrollH,i.contentWidth-s[10]),e[9].isStarted&&e[9].finish(i.scrollV,i.contentHeight-s[11])}onRemoveListeners(){let t=dou2d.$2d.stage;this.off(dou2d.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),t.off(dou2d.TouchEvent.TOUCH_END,this.onTouchEnd,this),t.off(dou2d.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.off(dou2d.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.off(dou2d.Event2D.REMOVED_FROM_STAGE,this.onRemoveListeners,this)}horizontalUpdateHandler(t){const e=this.$Scroller[10];e&&(e.scrollH=t),this.dispatchEvent(dou.Event.CHANGE)}verticalUpdateHandler(t){const e=this.$Scroller[10];e&&(e.scrollV=t),this.dispatchEvent(dou.Event.CHANGE)}horizontalEndHandler(){this.$Scroller[9].isPlaying||this.onChangeEnd()}verticalEndHanlder(){this.$Scroller[8].isPlaying||this.onChangeEnd()}onChangeEnd(){let e=this.$Scroller,i=this.horizontalScrollBar,s=this.verticalScrollBar;(i&&i.visible||s&&s.visible)&&(e[2]||(e[2]=new dou2d.Timer(200,1),e[2].on(dou2d.TimerEvent.TIMER_COMPLETE,this.onAutoHideTimer,this)),e[2].reset(),e[2].start()),this.dispatchUIEvent(t.UIEvent.CHANGE_END)}onAutoHideTimer(t){let e=this.horizontalScrollBar,i=this.verticalScrollBar;e&&e.autoVisibility&&(e.visible=!1),i&&i.autoVisibility&&(i.visible=!1)}updateDisplayList(t,e){super.updateDisplayList(t,e);let i=this.viewport;i&&(i.setLayoutBoundsSize(t,e),i.setLayoutBoundsPosition(0,0))}onSkinAdded(){this.horizontalScrollBar.touchChildren=!1,this.horizontalScrollBar.touchEnabled=!1,this.horizontalScrollBar.viewport=this.viewport,this.horizontalScrollBar.autoVisibility&&(this.horizontalScrollBar.visible=!1),this.verticalScrollBar.touchChildren=!1,this.verticalScrollBar.touchEnabled=!1,this.verticalScrollBar.viewport=this.viewport,this.verticalScrollBar.autoVisibility&&(this.verticalScrollBar.visible=!1)}stopAnimation(){let e=this.$Scroller,i=e[9],s=e[8];(i.isPlaying||s.isPlaying)&&this.dispatchUIEvent(t.UIEvent.CHANGE_END),i.stop(),s.stop();let n=this.verticalScrollBar,a=this.horizontalScrollBar;n&&n.autoVisibility&&(n.visible=!1),a&&a.autoVisibility&&(a.visible=!1)}}e.scrollThreshold=5,t.Scroller=e}(douUI||(douUI={})),function(t){class e extends t.ListBase{constructor(){super(),this._indexBeingUpdated=!1,this.requireSelection=!0,this.useVirtualLayout=!1}set dataProvider(i){let s=this._dataProvider;s&&s instanceof t.ViewStack&&(s.off(dou.Event.PROPERTY_CHANGE,this.onViewStackIndexChange,this),this.off(dou.Event.CHANGE,this.onIndexChanged,this)),i&&i instanceof t.ViewStack&&(i.on(dou.Event.PROPERTY_CHANGE,this.onViewStackIndexChange,this),this.on(dou.Event.CHANGE,this.onIndexChanged,this)),dou.superSetter(e,this,"dataProvider",i)}get dataProvider(){return dou.superGetter(e,this,"dataProvider")}createChildren(){if(!this._layout){let e=new t.HorizontalLayout;e.gap=0,e.horizontalAlign=10,e.verticalAlign=11,this.layout=e}super.createChildren()}onIndexChanged(t){this._indexBeingUpdated=!0,this._dataProvider.selectedIndex=this.selectedIndex,this._indexBeingUpdated=!1}onViewStackIndexChange(t){"selectedIndex"!=t.data||this._indexBeingUpdated||this.setSelectedIndex(this._dataProvider.selectedIndex,!1)}}t.TabBar=e}(douUI||(douUI={})),function(t){class e extends t.Group{constructor(){super(),this._showRoot=!1,this._keepStatus=!0,this._justOpenOne=!1,this._allowClose=!0,this._itemChangedFlag=!1,this._sizeChangedFlag=!1,this._itemPool=[]}set itemRenderers(t){this._itemRenderers=t}get itemRenderers(){return this._itemRenderers}set showRoot(t){this._showRoot=t}get showRoot(){return this._showRoot}set keepStatus(t){this._keepStatus=t}get keepStatus(){return this._keepStatus}set justOpenOne(t){this._justOpenOne=t}get justOpenOne(){return this._justOpenOne}set allowClose(t){this._allowClose=t}get allowClose(){return this._allowClose}set dataProvider(e){let i=this._treeDataProvider;this._dataProvider=e;let s=t.TreeUtil.getTree(this._dataProvider);if(this._keepStatus&&i){let e=[];t.TreeUtil.forEach(i,!1,t=>{t.expand&&e.push(t.data)}),t.TreeUtil.forEach(s,!1,t=>{-1!=e.indexOf(t.data)&&(t.expand=!0)})}this._treeDataProvider=s,this._itemChangedFlag=!0,this.invalidateProperties()}get dataProvider(){return this._dataProvider}set selectedItem(e){if(this._selectedItem==e)return;this._selectedItem=e,this._justOpenOne&&t.TreeUtil.forEach(this._treeDataProvider,!1,t=>{t.expand=!1});let i=t.TreeUtil.getTreeData(this._treeDataProvider,this._selectedItem);t.TreeUtil.expand(i),this._itemChangedFlag=!0,this.invalidateProperties()}get selectedItem(){return this._selectedItem}commitProperties(){if(super.commitProperties(),this._itemChangedFlag){this._itemChangedFlag=!1,this._selectedRenderer&&(this._selectedRenderer.selected=!1,this._selectedRenderer=void 0);let e=[];this._showRoot||(this._treeDataProvider.expand=!0),t.TreeUtil.forEach(this._treeDataProvider,!0,t=>{e.push(t)}),this._showRoot||e.shift();let i=[];for(let t=0;t<this._itemRenderers.length;t++)i.push(0);let s=this._itemPool;for(let t of e){let e=t.depth;s[e]||(s[e]=[]);let n,a=s[e],o=i[e];if(a[o])n=a[o],n.parent?this.setChildIndex(n,this.numChildren-1):this.addChild(n);else{n=new(0,this._itemRenderers[e]),n.on(dou2d.TouchEvent.TOUCH_TAP,this.onTap,this),a.push(n),this.addChild(n)}n.data=t,i[e]++,t.children?n.selected=t.expand:this._selectedItem===t.data&&(n.selected=!0,this._selectedRenderer=n)}for(let t=0;t<s.length;t++){let e=s[t],n=i[t];if(e&&n<e.length)for(let t=n;t<e.length;t++){e[t].removeSelf()}}this._sizeChangedFlag=!0}}updateDisplayList(t,e){super.updateDisplayList(t,e),this._sizeChangedFlag&&(this._sizeChangedFlag=!1,dou2d.callLater(()=>{this.scrollH+this.scrollRect.width>this.contentWidth&&(this.scrollH=Math.max(0,this.contentWidth-this.scrollRect.width)),this.scrollV+this.scrollRect.height>this.contentHeight&&(this.scrollV=Math.max(0,this.contentHeight-this.scrollRect.height))},this))}onTap(e){let i=e.currentTarget.data;this.dispatchEvent(dou.Event.CHANGING,i,!0)&&(i.children?(i.expand?this._allowClose&&(i.expand=!1):this._justOpenOne?(t.TreeUtil.forEach(this._treeDataProvider,!1,t=>{t.expand=!1}),t.TreeUtil.expand(i)):i.expand=!0,this._itemChangedFlag=!0,this.invalidateProperties(),this._selectedItem&&this.checkIsSelected(i)||(this.selectedItem=i.data,this.dispatchEvent(dou.Event.CHANGE,i,!0))):this._selectedItem!==i.data&&(this.selectedItem=i.data,this.dispatchEvent(dou.Event.CHANGE,i,!0)))}checkIsSelected(e){let i=this._selectedItem;if(!i)return!1;if(i===e.data)return!0;let s=t.TreeUtil.getTreeData(this._treeDataProvider,i);for(;s.parent;)if(s=s.parent,s===e)return!0;return!1}getVirtualElementAt(t){let e=this.getElementAt(t);if(e)return e.visible=!0,e}setVirtualElementIndicesInView(t,e){for(let i=0,s=this.numElements;i<s;i++){let s=this.getElementAt(i);(i<t||i>e)&&(s.visible=!1)}}expandItem(e){let i=t.TreeUtil.getTreeData(this._treeDataProvider,e);t.TreeUtil.expand(i),this._itemChangedFlag=!0,this.invalidateProperties()}closeItem(e,i){let s=t.TreeUtil.getTreeData(this._treeDataProvider,e);i?t.TreeUtil.forEach(s,!1,t=>{t.expand=!1}):s.expand=!1,this._itemChangedFlag=!0,this.invalidateProperties()}updateRenderListByDepth(t){let e=this._itemPool[t];if(e)for(let t of e)t.data=t.data}}t.Tree=e}(douUI||(douUI={})),function(t){class e extends t.Group{constructor(){super(),this.on(dou2d.Event2D.ADDED_TO_STAGE,this.onAddToStage,this),this.on(dou2d.Event2D.REMOVED_FROM_STAGE,this.onRemoveFromStage,this)}onAddToStage(t){this._stage.on(dou2d.Event2D.RESIZE,this.onResize,this),this.onResize()}onRemoveFromStage(t){this._stage.off(dou2d.Event2D.RESIZE,this.onResize,this)}onResize(t){let e=this._stage;this.$setWidth(e.stageWidth),this.$setHeight(e.stageHeight)}}t.UILayer=e}(douUI||(douUI={})),function(t){class e extends t.Group{constructor(){super(...arguments),this._proposedSelectedIndex=t.ListBase.NO_PROPOSED_SELECTION,this._selectedIndex=-1}get length(){return this.$children.length}set selectedChild(t){let e=this.getChildIndex(t);e>=0&&e<this.numChildren&&this.setSelectedIndex(e)}get selectedChild(){let t=this.selectedIndex;return t>=0&&t<this.numChildren?this.getChildAt(t):null}set selectedIndex(t){t=0|+t,this.setSelectedIndex(t)}get selectedIndex(){return this._proposedSelectedIndex!=t.ListBase.NO_PROPOSED_SELECTION?this._proposedSelectedIndex:this._selectedIndex}setSelectedIndex(t){t!=this.selectedIndex&&(this._proposedSelectedIndex=t,this.invalidateProperties(),this.dispatchEvent(dou.Event.PROPERTY_CHANGE,"selectedIndex"))}$childAdded(e,i){super.$childAdded(e,i),this.showOrHide(e,!1);let s=this.selectedIndex;-1==s?this.setSelectedIndex(i):i<=this.selectedIndex&&this._stage&&this.setSelectedIndex(s+1),this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,0,i,-1,[e,name])}$childRemoved(e,i){super.$childRemoved(e,i),this.showOrHide(e,!0);let s=this.selectedIndex;i==s?this.numChildren>0?0==i?(this._proposedSelectedIndex=0,this.invalidateProperties()):this.setSelectedIndex(0):this.setSelectedIndex(-1):i<s&&this.setSelectedIndex(s-1),this.dispatchCollectionEvent(t.CollectionEvent.COLLECTION_CHANGE,2,i,-1,[e.name])}commitProperties(){super.commitProperties(),this._proposedSelectedIndex!=t.ListBase.NO_PROPOSED_SELECTION&&(this.commitSelection(this._proposedSelectedIndex),this._proposedSelectedIndex=t.ListBase.NO_PROPOSED_SELECTION)}commitSelection(t){t>=0&&t<this.numChildren?(this._selectedIndex=t,this._selectedChild&&this.showOrHide(this._selectedChild,!1),this._selectedChild=this.getElementAt(this._selectedIndex),this.showOrHide(this._selectedChild,!0)):(this._selectedChild=null,this._selectedIndex=-1),this.invalidateSize(),this.invalidateDisplayList()}showOrHide(e,i){t.sys.isIUIComponent(e)&&(e.includeInLayout=i),e.visible=i}getItemAt(t){let e=this.$children[t];return e?e.name:""}getItemIndex(t){let e=this.$children,i=e.length;for(let s=0;s<i;s++)if(e[s].name==t)return s;return-1}}t.ViewStack=e}(douUI||(douUI={})),function(t){class e extends t.ScrollBarBase{updateDisplayList(t,e){super.updateDisplayList(t,e);let i=this.thumb,s=this._viewport;if(!i||!s)return;let n=dou.recyclable(dou2d.Rectangle);i.getPreferredBounds(n);let a=n.height,o=n.x;n.recycle();let h=s.scrollV,l=s.contentHeight,r=s.height;if(h<=0){let t=a*(1- -h/(.5*r));t=Math.max(5,Math.round(t)),i.setLayoutBoundsSize(NaN,t),i.setLayoutBoundsPosition(o,0)}else if(h>=l-r){let t=a*(1-(h-l+r)/(.5*r));t=Math.max(5,Math.round(t)),i.setLayoutBoundsSize(NaN,t),i.setLayoutBoundsPosition(o,e-t)}else{let t=(e-a)*h/(l-r);i.setLayoutBoundsSize(NaN,NaN),i.setLayoutBoundsPosition(o,t)}}onPropertyChanged(t){switch(t.data){case"scrollV":case"contentHeight":this.invalidateDisplayList()}}}t.VScrollBar=e}(douUI||(douUI={})),function(t){class e extends t.SliderBase{pointToValue(t,e){if(!this.thumb||!this.track)return 0;let i=this.$Range,s=i[0]-i[2],n=this.getThumbRange();return i[2]+(0!=n?(n-e)/n*s:0)}getThumbRange(){let t=dou.recyclable(dou2d.Rectangle);this.track.getLayoutBounds(t);let e=t.height;return this.thumb.getLayoutBounds(t),e-=t.height,t.recycle(),e}updateSkinDisplayList(){if(!this.thumb||!this.track)return;let t=this.$Range,e=this.getThumbRange(),i=t[0]-t[2],s=i>0?e-(this.pendingValue-t[2])/i*e:0,n=dou.recyclable(dou2d.Point),a=this.track.localToGlobal(0,s,n),o=a.x,h=a.y,l=this.thumb.parent.globalToLocal(o,h,n).y,r=dou.recyclable(dou2d.Rectangle),d=r.height;if(this.thumb.getLayoutBounds(r),this.thumb.setLayoutBoundsPosition(r.x,Math.round(l)),r.recycle(),this.trackHighlight){let t=this.trackHighlight.parent.globalToLocal(o,h,n).y;this.trackHighlight.y=Math.round(t+d),this.trackHighlight.height=Math.round(e-t)}n.recycle()}}t.VSlider=e}(douUI||(douUI={})),Object.defineProperties(dou.EventDispatcher.prototype,{dispatchCollectionEvent:{value:function(t,e,i,s,n,a,o){let h=dou.recyclable(douUI.CollectionEvent);h.$initCollectionEvent(t,o,e,i,s,n,a);let l=this.dispatch(h);return h.recycle(),l},enumerable:!1}}),function(t){class e extends dou.Event{get kind(){return this._kind}get location(){return this._location}get oldLocation(){return this._oldLocation}get items(){return this._items}get oldItems(){return this._oldItems}$initCollectionEvent(t,e,i,s,n,a,o){this.$initEvent(t,null,e),this._kind=i,this._location=0|+s,this._oldLocation=0|+n,this._items=a||[],this._oldItems=o||[]}onRecycle(){super.onRecycle(),this._kind=null,this._location=NaN,this._oldLocation=NaN,this._items=null,this._oldItems=null}}e.COLLECTION_CHANGE="collectionChange",t.CollectionEvent=e}(douUI||(douUI={})),Object.defineProperties(dou.EventDispatcher.prototype,{dispatchItemTapEvent:{value:function(t,e){let i=dou.recyclable(douUI.ItemTapEvent);i.$initItemTapEvent(t,e);let s=this.dispatch(i);return i.recycle(),s},enumerable:!1}}),function(t){class e extends dou2d.Event2D{get item(){return this._item}get itemRenderer(){return this._itemRenderer}get itemIndex(){return this._itemIndex}$initItemTapEvent(t,e){super.$initEvent2D(t),this._item=e.data,this._itemRenderer=e,this._itemIndex=e.itemIndex}onRecycle(){super.onRecycle(),this._item=null,this._itemRenderer=null,this._itemIndex=NaN}}e.ITEM_TAP="itemTap",t.ItemTapEvent=e}(douUI||(douUI={})),Object.defineProperties(dou.EventDispatcher.prototype,{dispatchUIEvent:{value:function(t,e,i){let s=dou.recyclable(douUI.UIEvent);s.$initUIEvent(t,e,i);let n=this.dispatch(s);return s.recycle(),n},enumerable:!1}}),function(t){class e extends dou2d.Event2D{$initUIEvent(t,e,i){this.$initEvent2D(t,null,e,i)}}e.CREATION_COMPLETE="creationComplete",e.MOVE="move",e.CHANGE_START="changeStart",e.CHANGE_END="changeEnd",e.CLOSING="closing",t.UIEvent=e}(douUI||(douUI={})),function(t){class e extends dou.EventDispatcher{constructor(){super(...arguments),this._useVirtualLayout=!1,this._typicalWidth=20,this._typicalHeight=20}set target(t){this._target!==t&&(this._target=t,this.clearVirtualLayoutCache())}get target(){return this._target}set useVirtualLayout(t){t=!!t,this._useVirtualLayout!=t&&(this._useVirtualLayout=t,this.dispatchEvent("useVirtualLayoutChanged"),this._useVirtualLayout&&!t&&this.clearVirtualLayoutCache(),this.target&&this.target.invalidateDisplayList())}get useVirtualLayout(){return this._useVirtualLayout}setTypicalSize(t,e){e=+e||20,(t=+t||20)===this._typicalWidth&&e===this._typicalHeight||(this._typicalWidth=t,this._typicalHeight=e,this._target&&this._target.invalidateSize())}scrollPositionChanged(){}clearVirtualLayoutCache(){}elementAdded(t){}elementRemoved(t){}getElementIndicesInView(){return null}measure(){}updateDisplayList(t,e){}}t.LayoutBase=e}(douUI||(douUI={})),function(t){class e extends t.LayoutBase{constructor(){super(),this._horizontalAlign=0,this._verticalAlign=0,this._gap=6,this._paddingLeft=0,this._paddingRight=0,this._paddingTop=0,this._paddingBottom=0,this._startIndex=-1,this._endIndex=-1,this._indexInViewCalculated=!1,this._maxElementSize=0,this._elementSizeTable=[]}set horizontalAlign(t){this._horizontalAlign!=t&&(this._horizontalAlign=t,this._target&&this._target.invalidateDisplayList())}get horizontalAlign(){return this._horizontalAlign}set verticalAlign(t){this._verticalAlign!=t&&(this._verticalAlign=t,this._target&&this._target.invalidateDisplayList())}get verticalAlign(){return this._verticalAlign}set gap(t){t=+t||0,this._gap!==t&&(this._gap=t,this.invalidateTargetLayout())}get gap(){return this._gap}set paddingLeft(t){t=+t||0,this._paddingLeft!==t&&(this._paddingLeft=t,this.invalidateTargetLayout())}get paddingLeft(){return this._paddingLeft}set paddingRight(t){t=+t||0,this._paddingRight!==t&&(this._paddingRight=t,this.invalidateTargetLayout())}get paddingRight(){return this._paddingRight}set paddingTop(t){t=+t||0,this._paddingTop!==t&&(this._paddingTop=t,this.invalidateTargetLayout())}get paddingTop(){return this._paddingTop}set paddingBottom(t){t=+t||0,this._paddingBottom!==t&&(this._paddingBottom=t,this.invalidateTargetLayout())}get paddingBottom(){return this._paddingBottom}invalidateTargetLayout(){let t=this._target;t&&(t.invalidateSize(),t.invalidateDisplayList())}measure(){this._target&&(this._useVirtualLayout?this.measureVirtual():this.measureReal())}measureReal(){}measureVirtual(){}updateDisplayList(t,e){let i=this._target;i&&(0!=i.numElements?this._useVirtualLayout?this.updateDisplayListVirtual(t,e):this.updateDisplayListReal(t,e):i.setContentSize(Math.ceil(this._paddingLeft+this._paddingRight),Math.ceil(this._paddingTop+this._paddingBottom)))}getStartPosition(t){return 0}getElementSize(t){return 0}getElementTotalSize(){return 0}elementRemoved(t){this._useVirtualLayout&&(super.elementRemoved(t),this._elementSizeTable.splice(t,1))}clearVirtualLayoutCache(){this._useVirtualLayout&&(this._elementSizeTable=[],this._maxElementSize=0)}findIndexAt(t,e,i){let s=.5*(e+i)|0,n=this.getStartPosition(s),a=this.getElementSize(s);return t>=n&&t<n+a+this._gap?s:e==i?-1:t<n?this.findIndexAt(t,e,Math.max(e,s-1)):this.findIndexAt(t,Math.min(s+1,i),i)}scrollPositionChanged(){if(super.scrollPositionChanged(),this._useVirtualLayout){this.getIndexInView()&&(this._indexInViewCalculated=!0,this.target.invalidateDisplayList())}}getIndexInView(){return!1}updateDisplayListVirtual(t,e){}updateDisplayListReal(t,e){}flexChildrenProportionally(t,e,i,s){let n,a=s.length;do{n=!0;let o=e-t*i/100;o>0?e-=o:o=0;let h=e/i;for(let t=0;t<a;t++){let l=s[t],r=l.percent*h;if(r<l.min){let h=l.min;l.size=h,s[t]=s[--a],s[a]=l,i-=l.percent,o>=h?o-=h:(e-=h-o,o=0),n=!1;break}if(r>l.max){let h=l.max;l.size=h,s[t]=s[--a],s[a]=l,i-=l.percent,o>=h?o-=h:(e-=h-o,o=0),n=!1;break}l.size=r}}while(!n)}}t.LinearLayoutBase=e}(douUI||(douUI={})),function(t){!function(t){t.ChildInfo=class{constructor(){this.size=0}}}(t.sys||(t.sys={}))}(douUI||(douUI={})),function(t){class e extends t.LayoutBase{measure(){super.measure(),t.sys.measure(this._target)}updateDisplayList(e,i){super.updateDisplayList(e,i);let s=this._target,n=t.sys.updateDisplayList(s,e,i);s.setContentSize(Math.ceil(n.x),Math.ceil(n.y))}}t.BasicLayout=e}(douUI||(douUI={})),function(t){class e extends t.LinearLayoutBase{measureReal(){let e=this._target,i=e.numElements,s=i,n=0,a=0,o=dou.recyclable(dou2d.Rectangle);for(let h=0;h<i;h++){let i=e.getElementAt(h);t.sys.isIUIComponent(i)&&i.includeInLayout?(i.getPreferredBounds(o),n+=o.width,a=Math.max(a,o.height)):s--}o.recycle(),n+=(s-1)*this._gap;let h=this._paddingLeft+this._paddingRight,l=this._paddingTop+this._paddingBottom;e.setMeasuredSize(n+h,a+l)}measureVirtual(){let e=this._target,i=this._typicalWidth,s=this.getElementTotalSize(),n=Math.max(this._maxElementSize,this._typicalHeight),a=dou.recyclable(dou2d.Rectangle),o=this._endIndex,h=this._elementSizeTable;for(let l=this._startIndex;l<o;l++){let o=e.getElementAt(l);t.sys.isIUIComponent(o)&&o.includeInLayout&&(o.getPreferredBounds(a),s+=a.width,s-=isNaN(h[l])?i:h[l],n=Math.max(n,a.height))}a.recycle();let l=this._paddingLeft+this._paddingRight,r=this._paddingTop+this._paddingBottom;e.setMeasuredSize(s+l,n+r)}updateDisplayListReal(e,i){let s=this._target,n=this._paddingLeft,a=this._paddingRight,o=this._paddingTop,h=this._paddingBottom,l=this._gap,r=Math.max(0,e-n-a),d=Math.max(0,i-o-h),u=10==this._horizontalAlign,c=10==this._verticalAlign||11==this._verticalAlign,p=0;c||(1==this._verticalAlign?p=.5:2==this._verticalAlign&&(p=1));let _,g,m,I=s.numElements,v=I,y=n,C=o,f=0,E=0,x=[],S=r,T=this._maxElementSize,L=dou.recyclable(dou2d.Rectangle);for(_=0;_<I;_++){let e=s.getElementAt(_);if(t.sys.isIUIComponent(e)&&e.includeInLayout)if(e.getPreferredBounds(L),T=Math.max(T,L.height),u)f+=L.width;else{let i=e.$UIComponent;isNaN(i[6])?S-=L.width:(E+=i[6],m=new t.sys.ChildInfo,m.layoutElement=e,m.percent=i[6],m.min=i[12],m.max=i[13],x.push(m))}else v--}S-=l*(v-1),S=S>0?S:0;let N,P=r-f-l*(v-1),U=v,R=new Map;if(u){if(P<0){for(N=S/v,_=0;_<I;_++)g=s.getElementAt(_),t.sys.isIUIComponent(g)&&g.includeInLayout&&(g.getPreferredBounds(L),L.width<=N&&(S-=L.width,U--));S=S>0?S:0}}else if(E>0){this.flexChildrenProportionally(r,S,E,x);let t=0,e=x.length;for(_=0;_<e;_++){m=x[_];let e=Math.round(m.size+t);t+=m.size-e,R.set(m.layoutElement,e),S-=e}S=S>0?S:0}1==this._horizontalAlign?y=n+.5*S:2==this._horizontalAlign&&(y=n+S);let $=n,b=o,A=0,B=0,w=Math.ceil(d);11==this._verticalAlign&&(w=Math.ceil(Math.max(d,T)));let D,M,z=0;for(_=0;_<I;_++){let e=0;if(g=s.getElementAt(_),t.sys.isIUIComponent(g)&&g.includeInLayout){if(g.getPreferredBounds(L),D=NaN,u?(M=NaN,P>0?M=S*L.width/f:P<0&&L.width>N&&(M=S/U),isNaN(M)||(D=Math.round(M+z),z+=M-D)):D=R.get(g),c)C=o,g.setLayoutBoundsSize(D,w),g.getLayoutBounds(L);else{let t=NaN,i=g.$UIComponent;if(!isNaN(g.percentHeight)){let e=Math.min(100,i[7]);t=Math.round(d*e*.01)}g.setLayoutBoundsSize(D,t),g.getLayoutBounds(L),e=(d-L.height)*p,e=e>0?e:0,C=o+e}g.setLayoutBoundsPosition(Math.round(y),Math.round(C)),A=Math.ceil(L.width),B=Math.ceil(L.height),$=Math.max($,y+A),b=Math.max(b,C+B),y+=A+l}}this._maxElementSize=T,s.setContentSize($+a,b+h)}updateDisplayListVirtual(e,i){let s=this._target;this._indexInViewCalculated?this._indexInViewCalculated=!1:this.getIndexInView();let n,a=this._paddingRight,o=this._paddingTop,h=this._paddingBottom,l=this._gap,r=s.numElements;if(-1==this._startIndex||-1==this._endIndex)return n=this.getStartPosition(r)-l+a,void s.setContentSize(n,s.contentHeight);let d=this._endIndex;s.setVirtualElementIndicesInView(this._startIndex,d);let u=10==this._verticalAlign||11==this._verticalAlign,c=11==this._verticalAlign,p=0;u||(1==this._verticalAlign?p=.5:2==this._verticalAlign&&(p=1));let _,g=dou.recyclable(dou2d.Rectangle),m=Math.max(0,i-o-h),I=Math.ceil(m),v=this._typicalHeight,y=this._typicalWidth,C=this._maxElementSize,f=Math.max(v,this._maxElementSize);if(c){for(let e=this._startIndex;e<=d;e++)_=s.getVirtualElementAt(e),t.sys.isIUIComponent(_)&&_.includeInLayout&&(_.getPreferredBounds(g),C=Math.max(C,g.height));I=Math.ceil(Math.max(m,C))}let E,x=0,S=0,T=0,L=!1,N=this._elementSizeTable;for(let e=this._startIndex;e<=d;e++){let i=0;_=s.getVirtualElementAt(e),t.sys.isIUIComponent(_)&&_.includeInLayout&&(_.getPreferredBounds(g),c||(C=Math.max(C,g.height)),u?(S=o,_.setLayoutBoundsSize(NaN,I),_.getLayoutBounds(g)):(_.getLayoutBounds(g),i=(m-g.height)*p,i=i>0?i:0,S=o+i),T=Math.max(T,g.height),L||(E=isNaN(N[e])?y:N[e],E!=g.width&&(L=!0)),N[e]=g.width,x=this.getStartPosition(e),_.setLayoutBoundsPosition(Math.round(x),Math.round(S)))}g.recycle(),T+=o+h,n=this.getStartPosition(r)-l+a,this._maxElementSize=C,s.setContentSize(n,T),(L||f<this._maxElementSize)&&s.invalidateSize()}getStartPosition(t){if(!this._useVirtualLayout&&this._target){let e=this._target.getElementAt(t);if(e)return e.x}let e=this._typicalWidth,i=this._paddingLeft,s=this._gap,n=this._elementSizeTable;for(let a=0;a<t;a++){let t=n[a];isNaN(t)&&(t=e),i+=t+s}return i}getElementSize(t){if(this._useVirtualLayout){let e=this._elementSizeTable[t];return isNaN(e)&&(e=this._typicalWidth),e}return this._target?this._target.getElementAt(t).width:0}getElementTotalSize(){let t=this._typicalWidth,e=this._gap,i=0,s=this._target.numElements,n=this._elementSizeTable;for(let a=0;a<s;a++){let s=n[a];isNaN(s)&&(s=t),i+=s+e}return i-=e,i}elementAdded(t){this.useVirtualLayout&&(super.elementAdded(t),this._elementSizeTable.splice(t,0,this._typicalWidth))}getIndexInView(){let t=this._target;if(!t||0==t.numElements)return this._startIndex=this._endIndex=-1,!1;let e=t.$UIComponent;if(e[10]<=0||e[11]<=0)return this._startIndex=this._endIndex=-1,!1;let i=t.numElements,s=this.getStartPosition(i-1)+this._elementSizeTable[i-1]+this._paddingRight,n=t.scrollH;if(n>s-this._paddingRight)return this._startIndex=-1,this._endIndex=-1,!1;let a=t.scrollH+e[10];if(a<this._paddingLeft)return this._startIndex=-1,this._endIndex=-1,!1;let o=this._startIndex,h=this._endIndex;return this._startIndex=this.findIndexAt(n,0,i-1),-1==this._startIndex&&(this._startIndex=0),this._endIndex=this.findIndexAt(a,0,i-1),-1==this._endIndex&&(this._endIndex=i-1),o!=this._startIndex||h!=this._endIndex}}t.HorizontalLayout=e}(douUI||(douUI={})),function(t){class e extends t.LinearLayoutBase{measureReal(){let e=this._target,i=e.numElements,s=i,n=0,a=0,o=dou.recyclable(dou2d.Rectangle);for(let h=0;h<i;h++){let i=e.getElementAt(h);t.sys.isIUIComponent(i)&&i.includeInLayout?(i.getPreferredBounds(o),a+=o.height,n=Math.max(n,o.width)):s--}o.recycle(),a+=(s-1)*this._gap;let h=this._paddingLeft+this._paddingRight,l=this._paddingTop+this._paddingBottom;e.setMeasuredSize(n+h,a+l)}measureVirtual(){let e=this._target,i=this._typicalHeight,s=this.getElementTotalSize(),n=Math.max(this._maxElementSize,this._typicalWidth),a=dou.recyclable(dou2d.Rectangle),o=this._endIndex,h=this._elementSizeTable;for(let l=this._startIndex;l<o;l++){let o=e.getElementAt(l);t.sys.isIUIComponent(o)&&o.includeInLayout&&(o.getPreferredBounds(a),s+=a.height,s-=isNaN(h[l])?i:h[l],n=Math.max(n,a.width))}a.recycle();let l=this._paddingLeft+this._paddingRight,r=this._paddingTop+this._paddingBottom;e.setMeasuredSize(n+l,s+r)}updateDisplayListReal(e,i){let s=this._target,n=this._paddingLeft,a=this._paddingRight,o=this._paddingTop,h=this._paddingBottom,l=this._gap,r=Math.max(0,e-n-a),d=Math.max(0,i-o-h),u=10==this._verticalAlign,c=10==this._horizontalAlign||11==this._horizontalAlign,p=0;c||(1==this._horizontalAlign?p=.5:2==this._horizontalAlign&&(p=1));let _,g,m,I=s.numElements,v=I,y=n,C=o,f=0,E=0,x=[],S=d,T=this._maxElementSize,L=dou.recyclable(dou2d.Rectangle);for(_=0;_<I;_++){let e=s.getElementAt(_);if(t.sys.isIUIComponent(e)&&e.includeInLayout)if(e.getPreferredBounds(L),T=Math.max(T,L.width),u)f+=L.height;else{let i=e.$UIComponent;isNaN(i[7])?S-=L.height:(E+=i[7],m=new t.sys.ChildInfo,m.layoutElement=e,m.percent=i[7],m.min=i[14],m.max=i[15],x.push(m))}else v--}S-=l*(v-1),S=S>0?S:0;let N,P=d-f-l*(v-1),U=v,R=new Map;if(u){if(P<0){for(N=S/v,_=0;_<I;_++)g=s.getElementAt(_),t.sys.isIUIComponent(g)&&g.includeInLayout&&(g.getPreferredBounds(L),L.height<=N&&(S-=L.height,U--));S=S>0?S:0}}else if(E>0){this.flexChildrenProportionally(d,S,E,x);let t=0,e=x.length;for(_=0;_<e;_++){m=x[_];let e=Math.round(m.size+t);t+=m.size-e,R.set(m.layoutElement,e),S-=e}S=S>0?S:0}1==this._verticalAlign?C=o+.5*S:2==this._verticalAlign&&(C=o+S);let $=n,b=o,A=0,B=0,w=Math.ceil(r);11==this._horizontalAlign&&(w=Math.ceil(Math.max(r,T)));let D,M,z=0;for(_=0;_<I;_++){let e=0;if(g=s.getElementAt(_),t.sys.isIUIComponent(g)&&g.includeInLayout){if(g.getPreferredBounds(L),D=NaN,u?(M=NaN,P>0?M=S*L.height/f:P<0&&L.height>N&&(M=S/U),isNaN(M)||(D=Math.round(M+z),z+=M-D)):D=R.get(g),c)y=n,g.setLayoutBoundsSize(w,D),g.getLayoutBounds(L);else{let t=NaN,i=g.$UIComponent;if(!isNaN(i[6])){let e=Math.min(100,i[6]);t=Math.round(r*e*.01)}g.setLayoutBoundsSize(t,D),g.getLayoutBounds(L),e=(r-L.width)*p,e=e>0?e:0,y=n+e}g.setLayoutBoundsPosition(Math.round(y),Math.round(C)),A=Math.ceil(L.width),B=Math.ceil(L.height),$=Math.max($,y+A),b=Math.max(b,C+B),C+=B+l}}this._maxElementSize=T,s.setContentSize($+a,b+h)}updateDisplayListVirtual(e,i){let s=this._target;this._indexInViewCalculated?this._indexInViewCalculated=!1:this.getIndexInView();let n,a=this._paddingBottom,o=this._paddingLeft,h=this._paddingRight,l=this._gap,r=s.numElements;if(-1==this._startIndex||-1==this._endIndex)return n=this.getStartPosition(r)-l+a,void s.setContentSize(s.contentWidth,n);let d=this._endIndex;s.setVirtualElementIndicesInView(this._startIndex,d);let u=10==this._horizontalAlign||11==this._horizontalAlign,c=11==this._horizontalAlign,p=0;u||(1==this._horizontalAlign?p=.5:2==this._horizontalAlign&&(p=1));let _,g=dou.recyclable(dou2d.Rectangle),m=Math.max(0,e-o-h),I=Math.ceil(m),v=this._typicalHeight,y=this._typicalWidth,C=this._maxElementSize,f=Math.max(y,this._maxElementSize);if(c){for(let e=this._startIndex;e<=d;e++)_=s.getVirtualElementAt(e),t.sys.isIUIComponent(_)&&_.includeInLayout&&(_.getPreferredBounds(g),C=Math.max(C,g.width));I=Math.ceil(Math.max(m,C))}let E,x=0,S=0,T=0,L=!1,N=this._elementSizeTable;for(let e=this._startIndex;e<=d;e++){let i=0;_=s.getVirtualElementAt(e),t.sys.isIUIComponent(_)&&_.includeInLayout&&(_.getPreferredBounds(g),c||(C=Math.max(C,g.width)),u?(x=o,_.setLayoutBoundsSize(I,NaN),_.getLayoutBounds(g)):(_.getLayoutBounds(g),i=(m-g.width)*p,i=i>0?i:0,x=o+i),T=Math.max(T,g.width),L||(E=isNaN(N[e])?v:N[e],E!=g.height&&(L=!0)),N[e]=g.height,S=this.getStartPosition(e),_.setLayoutBoundsPosition(Math.round(x),Math.round(S)))}g.recycle(),T+=o+h,n=this.getStartPosition(r)-l+a,this._maxElementSize=C,s.setContentSize(T,n),(L||f<this._maxElementSize)&&s.invalidateSize()}getStartPosition(t){if(!this._useVirtualLayout&&this._target){let e=this._target.getElementAt(t);if(e)return e.y}let e=this._typicalHeight,i=this._paddingTop,s=this._gap,n=this._elementSizeTable;for(let a=0;a<t;a++){let t=n[a];isNaN(t)&&(t=e),i+=t+s}return i}getElementSize(t){if(this._useVirtualLayout){let e=this._elementSizeTable[t];return isNaN(e)&&(e=this._typicalHeight),e}return this._target?this._target.getElementAt(t).height:0}getElementTotalSize(){let t=this._typicalHeight,e=this._gap,i=0,s=this._target.numElements,n=this._elementSizeTable;for(let a=0;a<s;a++){let s=n[a];isNaN(s)&&(s=t),i+=s+e}return i-=e,i}elementAdded(t){this._useVirtualLayout&&(super.elementAdded(t),this._elementSizeTable.splice(t,0,this._typicalHeight))}getIndexInView(){let t=this._target;if(!t||0==t.numElements)return this._startIndex=this._endIndex=-1,!1;let e=t.$UIComponent;if(0==e[10]||0==e[11])return this._startIndex=this._endIndex=-1,!1;let i=t.numElements,s=this.getStartPosition(i-1)+this._elementSizeTable[i-1]+this._paddingBottom,n=t.scrollV;if(n>s-this._paddingBottom)return this._startIndex=-1,this._endIndex=-1,!1;let a=t.scrollV+e[11];if(a<this._paddingTop)return this._startIndex=-1,this._endIndex=-1,!1;let o=this._startIndex,h=this._endIndex;return this._startIndex=this.findIndexAt(n,0,i-1),-1==this._startIndex&&(this._startIndex=0),this._endIndex=this.findIndexAt(a,0,i-1),-1==this._endIndex&&(this._endIndex=i-1),o!=this._startIndex||h!=this._endIndex}}t.VerticalLayout=e}(douUI||(douUI={})),function(t){class e extends t.LayoutBase{constructor(){super(...arguments),this._explicitHorizontalGap=NaN,this._horizontalGap=6,this._explicitVerticalGap=NaN,this._verticalGap=6,this._columnCount=-1,this._requestedColumnCount=0,this._rowCount=-1,this._requestedRowCount=0,this._explicitColumnWidth=NaN,this._columnWidth=NaN,this._explicitRowHeight=NaN,this._rowHeight=NaN,this._paddingLeft=0,this._paddingRight=0,this._paddingTop=0,this._paddingBottom=0,this._horizontalAlign=10,this._verticalAlign=10,this._columnAlign=0,this._rowAlign=0,this._orientation=0,this._startIndex=-1,this._endIndex=-1,this._indexInViewCalculated=!1,this._maxElementWidth=0,this._maxElementHeight=0}set horizontalGap(t){(t=+t)!==this._horizontalGap&&(this._explicitHorizontalGap=t,this._horizontalGap=t,this.invalidateTargetLayout())}get horizontalGap(){return this._horizontalGap}set verticalGap(t){(t=+t)!==this._verticalGap&&(this._explicitVerticalGap=t,this._verticalGap=t,this.invalidateTargetLayout())}get verticalGap(){return this._verticalGap}get columnCount(){return this._columnCount}set requestedColumnCount(t){t=+t||0,this._requestedColumnCount!==t&&(this._requestedColumnCount=t,this._columnCount=t,this.invalidateTargetLayout())}get requestedColumnCount(){return this._requestedColumnCount}get rowCount(){return this._rowCount}set requestedRowCount(t){t=+t||0,this._requestedRowCount!=t&&(this._requestedRowCount=t,this._rowCount=t,this.invalidateTargetLayout())}get requestedRowCount(){return this._requestedRowCount}set columnWidth(t){(t=+t)!==this._columnWidth&&(this._explicitColumnWidth=t,this._columnWidth=t,this.invalidateTargetLayout())}get columnWidth(){return this._columnWidth}set rowHeight(t){(t=+t)!==this._rowHeight&&(this._explicitRowHeight=t,this._rowHeight=t,this.invalidateTargetLayout())}get rowHeight(){return this._rowHeight}set paddingTop(t){t=+t||0,this._paddingTop!=t&&(this._paddingTop=t,this.invalidateTargetLayout())}get paddingTop(){return this._paddingTop}set paddingBottom(t){t=+t||0,this._paddingBottom!==t&&(this._paddingBottom=t,this.invalidateTargetLayout())}get paddingBottom(){return this._paddingBottom}set paddingLeft(t){t=+t||0,this._paddingLeft!=t&&(this._paddingLeft=t,this.invalidateTargetLayout())}get paddingLeft(){return this._paddingLeft}set paddingRight(t){t=+t||0,this._paddingRight!==t&&(this._paddingRight=t,this.invalidateTargetLayout())}get paddingRight(){return this._paddingRight}set horizontalAlign(t){this._horizontalAlign!=t&&(this._horizontalAlign=t,this.invalidateTargetLayout())}get horizontalAlign(){return this._horizontalAlign}set verticalAlign(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.invalidateTargetLayout())}get verticalAlign(){return this._verticalAlign}set columnAlign(t){this._columnAlign!=t&&(this._columnAlign=t,this.invalidateTargetLayout())}get columnAlign(){return this._columnAlign}set rowAlign(t){this._rowAlign!=t&&(this._rowAlign=t,this.invalidateTargetLayout())}get rowAlign(){return this._rowAlign}set orientation(t){this._orientation!=t&&(this._orientation=t,this.invalidateTargetLayout())}get orientation(){return this._orientation}invalidateTargetLayout(){let t=this._target;t&&(t.invalidateSize(),t.invalidateDisplayList())}measure(){let t=this._target;if(!t)return;let e=this._columnCount,i=this._rowCount,s=this._columnWidth,n=this._rowHeight,a=0,o=0,h=t.$UIComponent;this.calculateRowAndColumn(h[8],h[9]);let l=this._requestedColumnCount>0?this._requestedColumnCount:this._columnCount,r=this._requestedRowCount>0?this._requestedRowCount:this._rowCount,d=isNaN(this._horizontalGap)?0:this._horizontalGap,u=isNaN(this._verticalGap)?0:this._verticalGap;l>0&&(a=l*(this._columnWidth+d)-d),r>0&&(o=r*(this._rowHeight+u)-u);let c=this._paddingLeft+this._paddingRight,p=this._paddingTop+this._paddingBottom;t.setMeasuredSize(a+c,o+p),this._columnCount=e,this._rowCount=i,this._columnWidth=s,this._rowHeight=n}calculateRowAndColumn(e,i){let s=this._target,n=isNaN(this._horizontalGap)?0:this._horizontalGap,a=isNaN(this._verticalGap)?0:this._verticalGap;this._rowCount=this._columnCount=-1;let o=s.numElements,h=o;for(let e=0;e<h;e++){let i=s.getElementAt(e);!i||t.sys.isIUIComponent(i)&&i.includeInLayout||o--}if(0==o)return void(this._rowCount=this._columnCount=0);(isNaN(this._explicitColumnWidth)||isNaN(this._explicitRowHeight))&&this.updateMaxElementSize(),isNaN(this._explicitColumnWidth)?this._columnWidth=this._maxElementWidth:this._columnWidth=this._explicitColumnWidth,isNaN(this._explicitRowHeight)?this._rowHeight=this._maxElementHeight:this._rowHeight=this._explicitRowHeight;let l=this._columnWidth+n;l<=0&&(l=1);let r=this._rowHeight+a;r<=0&&(r=1);let d=1==this._orientation,u=!isNaN(e),c=!isNaN(i),p=this._paddingLeft,_=this._paddingRight,g=this._paddingTop,m=this._paddingBottom;if(this._requestedColumnCount>0||this._requestedRowCount>0)this._requestedRowCount>0&&(this._rowCount=Math.min(this._requestedRowCount,o)),this._requestedColumnCount>0&&(this._columnCount=Math.min(this._requestedColumnCount,o));else if(u||c)if(!u||c&&d){let t=Math.max(0,i-g-m);this._rowCount=Math.floor((t+a)/r),this._rowCount=Math.max(1,Math.min(this._rowCount,o))}else{let t=Math.max(0,e-p-_);this._columnCount=Math.floor((t+n)/l),this._columnCount=Math.max(1,Math.min(this._columnCount,o))}else{let t=Math.sqrt(o*l*r);d?this._rowCount=Math.max(1,Math.round(t/r)):this._columnCount=Math.max(1,Math.round(t/l))}-1==this._rowCount&&(this._rowCount=Math.max(1,Math.ceil(o/this._columnCount))),-1==this._columnCount&&(this._columnCount=Math.max(1,Math.ceil(o/this._rowCount))),this._requestedColumnCount>0&&this._requestedRowCount>0&&(0==this._orientation?this._rowCount=Math.max(1,Math.ceil(o/this._requestedColumnCount)):this._columnCount=Math.max(1,Math.ceil(o/this._requestedRowCount)))}updateMaxElementSize(){this._target&&(this._useVirtualLayout?(this._maxElementWidth=Math.max(this._maxElementWidth,this._typicalWidth),this._maxElementHeight=Math.max(this._maxElementHeight,this._typicalHeight),this.doUpdateMaxElementSize(this._startIndex,this._endIndex)):this.doUpdateMaxElementSize(0,this._target.numElements-1))}doUpdateMaxElementSize(e,i){let s=this._maxElementWidth,n=this._maxElementHeight,a=dou.recyclable(dou2d.Rectangle),o=this._target;if(-1!=e&&-1!=i)for(let h=e;h<=i;h++){let e=o.getVirtualElementAt(h);t.sys.isIUIComponent(e)&&e.includeInLayout&&(e.getPreferredBounds(a),s=Math.max(s,a.width),n=Math.max(n,a.height))}this._maxElementWidth=s,this._maxElementHeight=n,a.recycle()}clearVirtualLayoutCache(){super.clearVirtualLayoutCache(),this._maxElementWidth=0,this._maxElementHeight=0}scrollPositionChanged(){if(this._useVirtualLayout){this.getIndexInView()&&(this._indexInViewCalculated=!0,this._target.invalidateDisplayList())}}getIndexInView(){if(!this._target||0==this._target.numElements)return this._startIndex=this._endIndex=-1,!1;let t=this._target,e=t.numElements;if(!this._useVirtualLayout)return this._startIndex=0,this._endIndex=e-1,!1;let i=t.$UIComponent;if(0==i[10]||0==i[11])return this._startIndex=this._endIndex=-1,!1;let s=this._startIndex,n=this._endIndex,a=this._paddingLeft,o=this._paddingTop,h=isNaN(this._horizontalGap)?0:this._horizontalGap,l=isNaN(this._verticalGap)?0:this._verticalGap;if(1==this._orientation){let s=this._columnWidth+h;if(s<=0)return this._startIndex=0,this._endIndex=e-1,!1;let n=t.scrollH,o=n+i[10],l=Math.floor((n-a)/s);l<0&&(l=0);let r=Math.ceil((o-a)/s);r<0&&(r=0),this._startIndex=Math.min(e-1,Math.max(0,l*this._rowCount)),this._endIndex=Math.min(e-1,Math.max(0,r*this._rowCount-1))}else{let s=this._rowHeight+l;if(s<=0)return this._startIndex=0,this._endIndex=e-1,!1;let n=t.scrollV,a=n+i[11],h=Math.floor((n-o)/s);h<0&&(h=0);let r=Math.ceil((a-o)/s);r<0&&(r=0),this._startIndex=Math.min(e-1,Math.max(0,h*this._columnCount)),this._endIndex=Math.min(e-1,Math.max(0,r*this._columnCount-1))}return this._startIndex!=s||this._endIndex!=n}updateDisplayList(e,i){if(super.updateDisplayList(e,i),!this._target)return;let s=this._target,n=this._paddingLeft,a=this._paddingRight,o=this._paddingTop,h=this._paddingBottom;if(this._indexInViewCalculated)this._indexInViewCalculated=!1;else{if(this.calculateRowAndColumn(e,i),0==this._rowCount||0==this._columnCount)return void s.setContentSize(n+a,o+h);this.adjustForJustify(e,i),this.getIndexInView()}if(this._useVirtualLayout&&(this.calculateRowAndColumn(e,i),this.adjustForJustify(e,i)),-1==this._startIndex||-1==this._endIndex)return void s.setContentSize(0,0);let l,r,d,u,c,p=this._endIndex;s.setVirtualElementIndicesInView(this._startIndex,p);let _=1==this._orientation,g=this._startIndex,m=isNaN(this._horizontalGap)?0:this._horizontalGap,I=isNaN(this._verticalGap)?0:this._verticalGap,v=this._rowCount,y=this._columnCount,C=this._columnWidth,f=this._rowHeight;for(let s=this._startIndex;s<=p;s++)if(l=this._useVirtualLayout?this.target.getVirtualElementAt(s):this.target.getElementAt(s),t.sys.isIUIComponent(l)&&l.includeInLayout){switch(_?(u=Math.ceil((g+1)/v)-1,c=Math.ceil((g+1)%v)-1,-1==c&&(c=v-1)):(u=Math.ceil((g+1)%y)-1,-1==u&&(u=y-1),c=Math.ceil((g+1)/y)-1),this._horizontalAlign){case 2:r=e-(u+1)*(C+m)+m-a;break;case 0:r=u*(C+m)+n;break;default:r=u*(C+m)+n}switch(this._verticalAlign){case 0:d=c*(f+I)+o;break;case 2:d=i-(c+1)*(f+I)+I-h;break;default:d=c*(f+I)+o}this.sizeAndPositionElement(l,r,d,C,f),g++}let E=n+a,x=o+h,S=(C+m)*y-m,T=(f+I)*v-I;s.setContentSize(S+E,T+x)}sizeAndPositionElement(t,e,i,s,n){let a=NaN,o=NaN,h=t.$UIComponent;10==this._horizontalAlign?a=s:isNaN(h[6])||(a=s*h[6]*.01),10==this._verticalAlign?o=n:isNaN(h[7])||(o=n*h[7]*.01),t.setLayoutBoundsSize(Math.round(a),Math.round(o));let l=e,r=dou.recyclable(dou2d.Rectangle);switch(t.getLayoutBounds(r),this._horizontalAlign){case 2:l+=s-r.width;break;case 1:l=e+(s-r.width)/2}let d=i;switch(this._verticalAlign){case 2:d+=n-r.height;break;case 1:d+=(n-r.height)/2}t.setLayoutBoundsPosition(Math.round(l),Math.round(d)),r.recycle()}adjustForJustify(t,e){let i=this._paddingLeft,s=this._paddingRight,n=this._paddingTop,a=this._paddingBottom,o=Math.max(0,t-i-s),h=Math.max(0,e-n-a);isNaN(this._explicitVerticalGap)||(this._verticalGap=this._explicitVerticalGap),isNaN(this._explicitHorizontalGap)||(this._horizontalGap=this._explicitHorizontalGap),this._verticalGap=isNaN(this._verticalGap)?0:this._verticalGap,this._horizontalGap=isNaN(this._horizontalGap)?0:this._horizontalGap;let l,r=h-this._rowHeight*this._rowCount,d=o-this._columnWidth*this._columnCount;r>0&&(1==this._rowAlign?(l=Math.max(1,this._rowCount-1),this._verticalGap=r/l):2==this._rowAlign&&this._rowCount>0&&(this._rowHeight+=(r-(this._rowCount-1)*this._verticalGap)/this._rowCount)),d>0&&(1==this._columnAlign?(l=Math.max(1,this._columnCount-1),this._horizontalGap=d/l):2==this._columnAlign&&this._columnCount>0&&(this._columnWidth+=(d-(this._columnCount-1)*this._horizontalGap)/this._columnCount))}}t.TileLayout=e}(douUI||(douUI={})),function(t){t.SkinBase=class{constructor(t,e){this._skinCreated=!1,this._target=t,e&&(this._width=e.width,this._minWidth=e.minWidth,this._maxWidth=e.maxWidth,this._height=e.height,this._minHeight=e.minHeight,this._maxHeight=e.maxHeight)}get width(){return this._width}get minWidth(){return this._minWidth}get maxWidth(){return this._maxWidth}get height(){return this._height}get minHeight(){return this._minHeight}get maxHeight(){return this._maxHeight}bindToTarget(t,e){this._target[t]=e}onCreateSkin(){this._skinCreated||(this._skinCreated=!0,this.createSkin())}onApply(){this._skinCreated&&this.apply()}onUnload(){this._skinCreated&&this.unload()}setState(t){}}}(douUI||(douUI={})),function(t){let e;!function(t){let e=new Map,i={};t.registerDefaultSkin=function(t,i){if(e.has(t))throw new Error(`默认皮肤已经注册: ${t}`);e.set(t,i)},t.getDefaultSkin=function(t){return e.get(t)},t.registerSkin=function(t,e){if(i.hasOwnProperty(t))throw new Error(`皮肤别名已被注册: ${t}`);i[t]=e},t.getSkin=function(t){return i[t]}}(e=t.Theme||(t.Theme={}))}(douUI||(douUI={})),function(t){!function(t){let e;!function(t){const e=new dou2d.Rectangle;function i(t,e,i,s,n,o,h,l,r,d){let u;if(!isNaN(i)&&isNaN(s)){if(u=a(t,e,i,o,i,l,i,d),u)return u}else if(isNaN(i)&&!isNaN(s)&&(u=a(t,e,n,s,h,s,r,s),u))return u;return u=a(t,e,n,o,h,l,r,d),u}function s(t,e,i,s,a,o,h,l,r,d){let u;if(!isNaN(i)&&isNaN(s)){if(u=n(t,e,i,o,i,l,i,d),u)return u}else if(isNaN(i)&&!isNaN(s)&&(u=n(t,e,a,s,h,s,r,s),u))return u;return u=n(t,e,a,o,h,l,r,d),u}function n(t,e,i,s,n,a,l,r){let d=e.b,u=e.d;if(-1e-9<d&&d<1e-9&&(d=0),-1e-9<u&&u<1e-9&&(u=0),0==d&&0==u)return null;if(0==d&&0==u)return null;if(0==d){let e=dou.recyclable(dou2d.Point);return e.set(i,t/Math.abs(u)),e}if(0==u){let e=dou.recyclable(dou2d.Point);return e.set(t/Math.abs(d),s),e}let c,p,_,g=d*u>=0?u:-u;if(0!=g&&i>0){let s=1/g;p=i=Math.max(n,Math.min(l,i)),_=(t-d*p)*s,a<=_&&_<=r&&d*p+g*_>=0&&(c=dou.recyclable(dou2d.Point),c.set(p,_)),_=(-t-d*p)*s,a<=_&&_<=r&&d*p+g*_<0&&(!c||h(c.x,c.y,e).width>h(p,_,e).width)&&(c.recycle(),c=dou.recyclable(dou2d.Point),c.set(p,_))}if(0!=d&&s>0){let i=1/d;_=s=Math.max(a,Math.min(r,s)),p=(t-g*_)*i,n<=p&&p<=l&&d*p+g*_>=0&&(!c||h(c.x,c.y,e).width>h(p,_,e).width)&&(c=dou.recyclable(dou2d.Point),c.set(p,_)),p=(-t-g*_)*i,n<=p&&p<=l&&d*p+g*_<0&&(!c||h(c.x,c.y,e).width>h(p,_,e).width)&&(c.recycle(),c=dou.recyclable(dou2d.Point),c.set(p,_))}if(c)return c;let m=e.a,I=e.c;return o(d,g,t,n,a,l,r,m,m*I>=0?I:-I)}function a(t,e,i,s,n,a,l,r){let d=e.a,u=e.c;if(-1e-9<d&&d<1e-9&&(d=0),-1e-9<u&&u<1e-9&&(u=0),0==d&&0==u)return null;if(0==d){let e=dou.recyclable(dou2d.Point);return e.set(i,t/Math.abs(u)),e}if(0==u){let e=dou.recyclable(dou2d.Point);return e.set(t/Math.abs(d),s),e}let c,p,_,g=d*u>=0?u:-u;if(0!=g&&i>0){let s=1/g;if(p=i=Math.max(n,Math.min(l,i)),_=(t-d*p)*s,a<=_&&_<=r&&d*p+g*_>=0){dou.recyclable(dou2d.Point).set(p,_)}_=(-t-d*p)*s,a<=_&&_<=r&&d*p+g*_<0&&(!c||h(c.x,c.y,e).height>h(p,_,e).height)&&(c.recycle(),c=dou.recyclable(dou2d.Point),c.set(p,_))}if(0!=d&&s>0){let i=1/d;_=s=Math.max(a,Math.min(r,s)),p=(t-g*_)*i,n<=p&&p<=l&&d*p+g*_>=0&&(!c||h(c.x,c.y,e).height>h(p,_,e).height)&&(c.recycle(),c=dou.recyclable(dou2d.Point),c.set(p,_)),p=(-t-g*_)*i,n<=p&&p<=l&&d*p+g*_<0&&(!c||h(c.x,c.y,e).height>h(p,_,e).height)&&(c.recycle(),c=dou.recyclable(dou2d.Point),c.set(p,_))}if(c)return c;let m=e.b,I=e.d;return o(d,g,t,n,a,l,r,m,m*I>=0?I:-I)}function o(t,e,i,s,n,a,o,h,l){if(0==t||0==e)return null;let r,d,u=(i-s*t)/e,c=(i-a*t)/e,p=Math.max(n,Math.min(u,c)),_=Math.min(o,Math.max(u,c)),g=h*e-t*l;if(p<=_){d=Math.abs(g)<1e-9?i/(t+e):h*i/g,d=Math.max(p,Math.min(d,_)),r=(i-e*d)/t;let s=dou.recyclable(dou2d.Point);return s.set(r,d),s}if(u=-(s*t+i)/e,c=-(a*t+i)/e,p=Math.max(n,Math.min(u,c)),_=Math.min(o,Math.max(u,c)),p<=_){d=Math.abs(g)<1e-9?-i/(t+e):-h*i/g,d=Math.max(p,Math.min(d,_)),r=(-i-e*d)/t;let s=dou.recyclable(dou2d.Point);return s.set(r,d),s}return null}function h(t,i,s){let n=e.set(0,0,t,i);return s.transformBounds(n),n}function l(t,e,i,s,n,a){let o=dou.recyclable(dou2d.Point);return o.set(s*n-e*a,t*a-i*n),o}t.isDeltaIdentity=function(t){return 1===t.a&&0===t.b&&0===t.c&&1===t.d},t.fitBounds=function(t,e,n,a,r,d,u,c,p,_,g){if(isNaN(t)&&isNaN(e)){let t=dou.recyclable(dou2d.Point);return t.set(d,u),t}let m,I=c<.1?0:c-.1,v=p<.1?0:p-.1,y=_+.1,C=g+.1;if(!isNaN(t)&&!isNaN(e)){if(m=function(t,e,i,s,n,a,h){let r=i.a,d=i.b,u=i.c,c=i.d;-1e-9<r&&r<1e-9&&(r=0);-1e-9<d&&d<1e-9&&(d=0);-1e-9<u&&u<1e-9&&(u=0);-1e-9<c&&c<1e-9&&(c=0);if(0==d&&0==u){if(0==r||0==c)return null;let i=dou.recyclable(dou2d.Point);return i.set(t/Math.abs(r),e/Math.abs(c)),i}if(0==r&&0==c){if(0==d||0==u)return null;let i=dou.recyclable(dou2d.Point);return i.set(e/Math.abs(d),t/Math.abs(u)),i}let p=r*u>=0?u:-u,_=d*c>=0?c:-c,g=r*_-d*p;if(Math.abs(g)<1e-9)return 0==p||0==r||r==-p||Math.abs(r*e-d*t)>1e-9?null:o(r,p,t,s,s,a,h,d,_);let m,I=1/g;if(m=l(r,p,d,_,t*=I,e*=I),m&&s<=m.x&&m.x<=a&&n<=m.y&&m.y<=h&&r*m.x+p*m.x>=0&&d*m.x+_*m.y>=0)return m;if(m=l(r,p,d,_,t,-e),m&&s<=m.x&&m.x<=a&&n<=m.y&&m.y<=h&&r*m.x+p*m.x>=0&&d*m.x+_*m.y<0)return m;if(m=l(r,p,d,_,-t,e),m&&s<=m.x&&m.x<=a&&n<=m.y&&m.y<=h&&r*m.x+p*m.x<0&&d*m.x+_*m.y>=0)return m;if(m=l(r,p,d,_,-t,-e),m&&s<=m.x&&m.x<=a&&n<=m.y&&m.y<=h&&r*m.x+p*m.x<0&&d*m.x+_*m.y<0)return m;return m.recycle(),null}(t,e,n,I,v,y,C),!m){let o,l;if(o=i(t,n,a,r,d,u,I,v,y,C),o){h(o.x,o.y,n).height-.1>e&&(o.recycle(),o=null)}if(l=s(e,n,a,r,d,u,I,v,y,C),l){h(l.x,l.y,n).width-.1>t&&(l.recycle(),l=null)}m=o&&l?o.x*o.y>l.x*l.y?o:l:o||l,o.recycle(),l.recycle()}return m}return isNaN(t)?s(e,n,a,r,d,u,I,v,y,C):i(t,n,a,r,d,u,I,v,y,C)}}(e=t.MatrixUtil||(t.MatrixUtil={}))}(t.sys||(t.sys={}))}(douUI||(douUI={})),function(t){let e;!function(t){t.getTree=function(t){if(!t)return;let e={};return function t(e,i,s,n){s.depth=i,s.data=e,s.parent=n,s.expand=!1;let a=e.children;if(a&&Array.isArray(a)&&a.length>0){s.children=[];for(let e of a){let n={};t(e,i+1,n,s),s.children.push(n)}}}(t,0,e),e},t.forEach=function t(e,i,s,n){s.call(n,e);let a=e.children;if(a&&a.length>0&&(!i||e.expand))for(let e of a)t(e,i,s,n)},t.getTreeData=function(e,i){let s;return t.forEach(e,!1,t=>{t.data===i&&(s=t)}),s},t.expand=function(t){for(t.expand=!0;t.parent;)(t=t.parent).expand=!0}}(e=t.TreeUtil||(t.TreeUtil={}))}(douUI||(douUI={})),function(t){t.sys=t.sys||{},t.DefaultAssetAdapter=douUI.DefaultAssetAdapter,t.getAsset=douUI.getAsset,t.ArrayCollection=douUI.ArrayCollection,t.sys.Animation=douUI.sys.Animation,t.ListBase=douUI.ListBase,t.Range=douUI.Range,t.ScrollBarBase=douUI.ScrollBarBase,t.SliderBase=douUI.SliderBase,t.sys.TouchScroll=douUI.sys.TouchScroll,t.BitmapLabel=douUI.BitmapLabel,t.Button=douUI.Button,t.CheckBox=douUI.CheckBox,t.Component=douUI.Component,t.DataGroup=douUI.DataGroup,t.EditableText=douUI.EditableText,t.Group=douUI.Group,t.HScrollBar=douUI.HScrollBar,t.HSlider=douUI.HSlider,t.Image=douUI.Image,t.ItemRenderer=douUI.ItemRenderer,t.Label=douUI.Label,t.List=douUI.List,t.ProgressBar=douUI.ProgressBar,t.RadioButton=douUI.RadioButton,t.RadioButtonGroup=douUI.RadioButtonGroup,t.Rect=douUI.Rect,t.RichLabel=douUI.RichLabel,t.Scroller=douUI.Scroller,t.TabBar=douUI.TabBar,t.ToggleButton=douUI.ToggleButton,t.Tree=douUI.Tree,t.UILayer=douUI.UILayer,t.ViewStack=douUI.ViewStack,t.VScrollBar=douUI.VScrollBar,t.VSlider=douUI.VSlider,t.sys.UIComponentImpl=douUI.sys.UIComponentImpl,t.sys.Validator=douUI.sys.Validator,t.CollectionEvent=douUI.CollectionEvent,t.ItemTapEvent=douUI.ItemTapEvent,t.UIEvent=douUI.UIEvent,t.sys.ChildInfo=douUI.sys.ChildInfo,t.LayoutBase=douUI.LayoutBase,t.LinearLayoutBase=douUI.LinearLayoutBase,t.BasicLayout=douUI.BasicLayout,t.HorizontalLayout=douUI.HorizontalLayout,t.TileLayout=douUI.TileLayout,t.VerticalLayout=douUI.VerticalLayout,t.SkinBase=douUI.SkinBase,t.Theme=douUI.Theme,t.sys.implementUIComponent=douUI.sys.implementUIComponent,t.sys.mixin=douUI.sys.mixin,t.sys.isIUIComponent=douUI.sys.isIUIComponent,t.sys.measure=douUI.sys.measure,t.sys.updateDisplayList=douUI.sys.updateDisplayList,t.sys.MatrixUtil=douUI.sys.MatrixUtil,t.TreeUtil=douUI.TreeUtil}(window.Dou||(window.Dou={}));